ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"tos_priority_message_queue.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.prio_msg_q_task_recv,"ax",%progbits
  16              		.align	1
  17              		.arch armv7-m
  18              		.syntax unified
  19              		.thumb
  20              		.thumb_func
  21              		.fpu softvfp
  23              	prio_msg_q_task_recv:
  24              	.LVL0:
  25              	.LFB116:
  26              		.file 1 "..//kernel/core/tos_priority_message_queue.c"
   1:..//kernel/core/tos_priority_message_queue.c **** /*----------------------------------------------------------------------------
   2:..//kernel/core/tos_priority_message_queue.c ****  * Tencent is pleased to support the open source community by making TencentOS
   3:..//kernel/core/tos_priority_message_queue.c ****  * available.
   4:..//kernel/core/tos_priority_message_queue.c ****  *
   5:..//kernel/core/tos_priority_message_queue.c ****  * Copyright (C) 2019 THL A29 Limited, a Tencent company. All rights reserved.
   6:..//kernel/core/tos_priority_message_queue.c ****  * If you have downloaded a copy of the TencentOS binary from Tencent, please
   7:..//kernel/core/tos_priority_message_queue.c ****  * note that the TencentOS binary is licensed under the BSD 3-Clause License.
   8:..//kernel/core/tos_priority_message_queue.c ****  *
   9:..//kernel/core/tos_priority_message_queue.c ****  * If you have downloaded a copy of the TencentOS source code from Tencent,
  10:..//kernel/core/tos_priority_message_queue.c ****  * please note that TencentOS source code is licensed under the BSD 3-Clause
  11:..//kernel/core/tos_priority_message_queue.c ****  * License, except for the third-party components listed below which are
  12:..//kernel/core/tos_priority_message_queue.c ****  * subject to different license terms. Your integration of TencentOS into your
  13:..//kernel/core/tos_priority_message_queue.c ****  * own projects may require compliance with the BSD 3-Clause License, as well
  14:..//kernel/core/tos_priority_message_queue.c ****  * as the other licenses applicable to the third-party components included
  15:..//kernel/core/tos_priority_message_queue.c ****  * within TencentOS.
  16:..//kernel/core/tos_priority_message_queue.c ****  *---------------------------------------------------------------------------*/
  17:..//kernel/core/tos_priority_message_queue.c **** 
  18:..//kernel/core/tos_priority_message_queue.c **** #include "tos_k.h"
  19:..//kernel/core/tos_priority_message_queue.c **** 
  20:..//kernel/core/tos_priority_message_queue.c **** #if TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN > 0u
  21:..//kernel/core/tos_priority_message_queue.c **** 
  22:..//kernel/core/tos_priority_message_queue.c **** __API__ k_err_t tos_prio_msg_q_create(k_prio_msg_q_t *prio_msg_q, void *pool, size_t msg_cnt)
  23:..//kernel/core/tos_priority_message_queue.c **** {
  24:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
  25:..//kernel/core/tos_priority_message_queue.c ****     void *prio_q_mgr_array = K_NULL;
  26:..//kernel/core/tos_priority_message_queue.c **** 
  27:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
  28:..//kernel/core/tos_priority_message_queue.c **** 
  29:..//kernel/core/tos_priority_message_queue.c ****     prio_q_mgr_array = tos_mmheap_alloc(TOS_PRIO_Q_MGR_ARRAY_SIZE(msg_cnt));
  30:..//kernel/core/tos_priority_message_queue.c ****     if (!prio_q_mgr_array) {
  31:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_OUT_OF_MEMORY;
  32:..//kernel/core/tos_priority_message_queue.c ****     }
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 2


  33:..//kernel/core/tos_priority_message_queue.c **** 
  34:..//kernel/core/tos_priority_message_queue.c ****     err = tos_prio_q_create(&prio_msg_q->prio_q, prio_q_mgr_array, pool, msg_cnt, sizeof(void *));
  35:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
  36:..//kernel/core/tos_priority_message_queue.c ****         tos_mmheap_free(prio_q_mgr_array);
  37:..//kernel/core/tos_priority_message_queue.c ****         return err;
  38:..//kernel/core/tos_priority_message_queue.c ****     }
  39:..//kernel/core/tos_priority_message_queue.c **** 
  40:..//kernel/core/tos_priority_message_queue.c ****     prio_msg_q->prio_q_mgr_array = prio_q_mgr_array;
  41:..//kernel/core/tos_priority_message_queue.c ****     pend_object_init(&prio_msg_q->pend_obj);
  42:..//kernel/core/tos_priority_message_queue.c **** 
  43:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_INIT(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
  44:..//kernel/core/tos_priority_message_queue.c ****     knl_object_alloc_set_static(&prio_msg_q->knl_obj);
  45:..//kernel/core/tos_priority_message_queue.c **** 
  46:..//kernel/core/tos_priority_message_queue.c ****     return K_ERR_NONE;
  47:..//kernel/core/tos_priority_message_queue.c **** }
  48:..//kernel/core/tos_priority_message_queue.c **** 
  49:..//kernel/core/tos_priority_message_queue.c **** __API__ k_err_t tos_prio_msg_q_destroy(k_prio_msg_q_t *prio_msg_q)
  50:..//kernel/core/tos_priority_message_queue.c **** {
  51:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_CPSR_ALLOC();
  52:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
  53:..//kernel/core/tos_priority_message_queue.c **** 
  54:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
  55:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
  56:..//kernel/core/tos_priority_message_queue.c **** 
  57:..//kernel/core/tos_priority_message_queue.c ****     if (!knl_object_alloc_is_static(&prio_msg_q->knl_obj)) {
  58:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_OBJ_INVALID_ALLOC_TYPE;
  59:..//kernel/core/tos_priority_message_queue.c ****     }
  60:..//kernel/core/tos_priority_message_queue.c **** 
  61:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_INT_DISABLE();
  62:..//kernel/core/tos_priority_message_queue.c **** 
  63:..//kernel/core/tos_priority_message_queue.c ****     err = tos_prio_q_destroy(&prio_msg_q->prio_q);
  64:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
  65:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
  66:..//kernel/core/tos_priority_message_queue.c ****         return err;
  67:..//kernel/core/tos_priority_message_queue.c ****     }
  68:..//kernel/core/tos_priority_message_queue.c **** 
  69:..//kernel/core/tos_priority_message_queue.c ****     pend_wakeup_all(&prio_msg_q->pend_obj, PEND_STATE_DESTROY);
  70:..//kernel/core/tos_priority_message_queue.c **** 
  71:..//kernel/core/tos_priority_message_queue.c ****     tos_mmheap_free(prio_msg_q->prio_q_mgr_array);
  72:..//kernel/core/tos_priority_message_queue.c ****     prio_msg_q->prio_q_mgr_array = K_NULL;
  73:..//kernel/core/tos_priority_message_queue.c **** 
  74:..//kernel/core/tos_priority_message_queue.c ****     pend_object_deinit(&prio_msg_q->pend_obj);
  75:..//kernel/core/tos_priority_message_queue.c **** 
  76:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_DEINIT(prio_msg_q);
  77:..//kernel/core/tos_priority_message_queue.c ****     knl_object_alloc_reset(&prio_msg_q->knl_obj);
  78:..//kernel/core/tos_priority_message_queue.c **** 
  79:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_INT_ENABLE();
  80:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
  81:..//kernel/core/tos_priority_message_queue.c **** 
  82:..//kernel/core/tos_priority_message_queue.c ****     return K_ERR_NONE;
  83:..//kernel/core/tos_priority_message_queue.c **** }
  84:..//kernel/core/tos_priority_message_queue.c **** 
  85:..//kernel/core/tos_priority_message_queue.c **** __API__ k_err_t tos_prio_msg_q_create_dyn(k_prio_msg_q_t *prio_msg_q, size_t msg_cnt)
  86:..//kernel/core/tos_priority_message_queue.c **** {
  87:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
  88:..//kernel/core/tos_priority_message_queue.c **** 
  89:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 3


  90:..//kernel/core/tos_priority_message_queue.c **** 
  91:..//kernel/core/tos_priority_message_queue.c ****     err = tos_prio_q_create_dyn(&prio_msg_q->prio_q, msg_cnt, sizeof(void *));
  92:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
  93:..//kernel/core/tos_priority_message_queue.c ****         return err;
  94:..//kernel/core/tos_priority_message_queue.c ****     }
  95:..//kernel/core/tos_priority_message_queue.c **** 
  96:..//kernel/core/tos_priority_message_queue.c ****     pend_object_init(&prio_msg_q->pend_obj);
  97:..//kernel/core/tos_priority_message_queue.c **** 
  98:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_INIT(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
  99:..//kernel/core/tos_priority_message_queue.c ****     knl_object_alloc_set_dynamic(&prio_msg_q->knl_obj);
 100:..//kernel/core/tos_priority_message_queue.c **** 
 101:..//kernel/core/tos_priority_message_queue.c ****     return K_ERR_NONE;
 102:..//kernel/core/tos_priority_message_queue.c **** }
 103:..//kernel/core/tos_priority_message_queue.c **** 
 104:..//kernel/core/tos_priority_message_queue.c **** __API__ k_err_t tos_prio_msg_q_destroy_dyn(k_prio_msg_q_t *prio_msg_q)
 105:..//kernel/core/tos_priority_message_queue.c **** {
 106:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_CPSR_ALLOC();
 107:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
 108:..//kernel/core/tos_priority_message_queue.c **** 
 109:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
 110:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 111:..//kernel/core/tos_priority_message_queue.c **** 
 112:..//kernel/core/tos_priority_message_queue.c ****     if (!knl_object_alloc_is_dynamic(&prio_msg_q->knl_obj)) {
 113:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_OBJ_INVALID_ALLOC_TYPE;
 114:..//kernel/core/tos_priority_message_queue.c ****     }
 115:..//kernel/core/tos_priority_message_queue.c **** 
 116:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_INT_DISABLE();
 117:..//kernel/core/tos_priority_message_queue.c **** 
 118:..//kernel/core/tos_priority_message_queue.c ****     err = tos_prio_q_destroy_dyn(&prio_msg_q->prio_q);
 119:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 120:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 121:..//kernel/core/tos_priority_message_queue.c ****         return err;
 122:..//kernel/core/tos_priority_message_queue.c ****     }
 123:..//kernel/core/tos_priority_message_queue.c **** 
 124:..//kernel/core/tos_priority_message_queue.c ****     pend_wakeup_all(&prio_msg_q->pend_obj, PEND_STATE_DESTROY);
 125:..//kernel/core/tos_priority_message_queue.c **** 
 126:..//kernel/core/tos_priority_message_queue.c ****     tos_mmheap_free(prio_msg_q->prio_q_mgr_array);
 127:..//kernel/core/tos_priority_message_queue.c ****     prio_msg_q->prio_q_mgr_array = K_NULL;
 128:..//kernel/core/tos_priority_message_queue.c **** 
 129:..//kernel/core/tos_priority_message_queue.c ****     pend_object_deinit(&prio_msg_q->pend_obj);
 130:..//kernel/core/tos_priority_message_queue.c **** 
 131:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_DEINIT(prio_msg_q);
 132:..//kernel/core/tos_priority_message_queue.c ****     knl_object_alloc_reset(&prio_msg_q->knl_obj);
 133:..//kernel/core/tos_priority_message_queue.c **** 
 134:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_INT_ENABLE();
 135:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 136:..//kernel/core/tos_priority_message_queue.c **** 
 137:..//kernel/core/tos_priority_message_queue.c ****     return K_ERR_NONE;
 138:..//kernel/core/tos_priority_message_queue.c **** }
 139:..//kernel/core/tos_priority_message_queue.c **** 
 140:..//kernel/core/tos_priority_message_queue.c **** __API__ k_err_t tos_prio_msg_q_flush(k_prio_msg_q_t *prio_msg_q)
 141:..//kernel/core/tos_priority_message_queue.c **** {
 142:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
 143:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 144:..//kernel/core/tos_priority_message_queue.c **** 
 145:..//kernel/core/tos_priority_message_queue.c ****     return tos_prio_q_flush(&prio_msg_q->prio_q);
 146:..//kernel/core/tos_priority_message_queue.c **** }
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 4


 147:..//kernel/core/tos_priority_message_queue.c **** 
 148:..//kernel/core/tos_priority_message_queue.c **** __API__ k_err_t tos_prio_msg_q_pend(k_prio_msg_q_t *prio_msg_q, void **msg_ptr, k_tick_t timeout)
 149:..//kernel/core/tos_priority_message_queue.c **** {
 150:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_CPSR_ALLOC();
 151:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
 152:..//kernel/core/tos_priority_message_queue.c **** 
 153:..//kernel/core/tos_priority_message_queue.c ****     TOS_IN_IRQ_CHECK();
 154:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
 155:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(msg_ptr);
 156:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 157:..//kernel/core/tos_priority_message_queue.c **** 
 158:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_INT_DISABLE();
 159:..//kernel/core/tos_priority_message_queue.c **** 
 160:..//kernel/core/tos_priority_message_queue.c ****     if (tos_prio_q_dequeue(&prio_msg_q->prio_q, msg_ptr, K_NULL, K_NULL) == K_ERR_NONE) {
 161:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 162:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_NONE;
 163:..//kernel/core/tos_priority_message_queue.c ****     }
 164:..//kernel/core/tos_priority_message_queue.c **** 
 165:..//kernel/core/tos_priority_message_queue.c ****     if (timeout == TOS_TIME_NOWAIT) {
 166:..//kernel/core/tos_priority_message_queue.c ****         *msg_ptr = K_NULL;
 167:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 168:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_PEND_NOWAIT;
 169:..//kernel/core/tos_priority_message_queue.c ****     }
 170:..//kernel/core/tos_priority_message_queue.c **** 
 171:..//kernel/core/tos_priority_message_queue.c ****     if (knl_is_sched_locked()) {
 172:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 173:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_PEND_SCHED_LOCKED;
 174:..//kernel/core/tos_priority_message_queue.c ****     }
 175:..//kernel/core/tos_priority_message_queue.c **** 
 176:..//kernel/core/tos_priority_message_queue.c ****     pend_task_block(k_curr_task, &prio_msg_q->pend_obj, timeout);
 177:..//kernel/core/tos_priority_message_queue.c **** 
 178:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_INT_ENABLE();
 179:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 180:..//kernel/core/tos_priority_message_queue.c **** 
 181:..//kernel/core/tos_priority_message_queue.c ****     err = pend_state2errno(k_curr_task->pend_state);
 182:..//kernel/core/tos_priority_message_queue.c ****     if (err == K_ERR_NONE) {
 183:..//kernel/core/tos_priority_message_queue.c ****         *msg_ptr            = k_curr_task->msg;
 184:..//kernel/core/tos_priority_message_queue.c ****         k_curr_task->msg    = K_NULL;
 185:..//kernel/core/tos_priority_message_queue.c ****     }
 186:..//kernel/core/tos_priority_message_queue.c **** 
 187:..//kernel/core/tos_priority_message_queue.c ****     return err;
 188:..//kernel/core/tos_priority_message_queue.c **** }
 189:..//kernel/core/tos_priority_message_queue.c **** 
 190:..//kernel/core/tos_priority_message_queue.c **** __STATIC__ void prio_msg_q_task_recv(k_task_t *task, void *msg_ptr)
 191:..//kernel/core/tos_priority_message_queue.c **** {
  27              		.loc 1 191 1 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		.loc 1 191 1 is_stmt 0 view .LVU1
  32 0000 08B5     		push	{r3, lr}
  33              	.LCFI0:
  34              		.cfi_def_cfa_offset 8
  35              		.cfi_offset 3, -8
  36              		.cfi_offset 14, -4
 192:..//kernel/core/tos_priority_message_queue.c ****     task->msg = msg_ptr;
  37              		.loc 1 192 5 is_stmt 1 view .LVU2
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 5


  38              		.loc 1 192 15 is_stmt 0 view .LVU3
  39 0002 C166     		str	r1, [r0, #108]
 193:..//kernel/core/tos_priority_message_queue.c ****     pend_task_wakeup(task, PEND_STATE_POST);
  40              		.loc 1 193 5 is_stmt 1 view .LVU4
  41 0004 0121     		movs	r1, #1
  42              	.LVL1:
  43              		.loc 1 193 5 is_stmt 0 view .LVU5
  44 0006 FFF7FEFF 		bl	pend_task_wakeup
  45              	.LVL2:
 194:..//kernel/core/tos_priority_message_queue.c **** }
  46              		.loc 1 194 1 view .LVU6
  47 000a 08BD     		pop	{r3, pc}
  48              		.cfi_endproc
  49              	.LFE116:
  51              		.section	.text.prio_msg_q_do_post,"ax",%progbits
  52              		.align	1
  53              		.syntax unified
  54              		.thumb
  55              		.thumb_func
  56              		.fpu softvfp
  58              	prio_msg_q_do_post:
  59              	.LVL3:
  60              	.LFB117:
 195:..//kernel/core/tos_priority_message_queue.c **** 
 196:..//kernel/core/tos_priority_message_queue.c **** __STATIC__ k_err_t prio_msg_q_do_post(k_prio_msg_q_t *prio_msg_q, void *msg_ptr, k_prio_t prio, opt
 197:..//kernel/core/tos_priority_message_queue.c **** {
  61              		.loc 1 197 1 is_stmt 1 view -0
  62              		.cfi_startproc
  63              		@ args = 0, pretend = 0, frame = 8
  64              		@ frame_needed = 0, uses_anonymous_args = 0
  65              		.loc 1 197 1 is_stmt 0 view .LVU8
  66 0000 F0B5     		push	{r4, r5, r6, r7, lr}
  67              	.LCFI1:
  68              		.cfi_def_cfa_offset 20
  69              		.cfi_offset 4, -20
  70              		.cfi_offset 5, -16
  71              		.cfi_offset 6, -12
  72              		.cfi_offset 7, -8
  73              		.cfi_offset 14, -4
  74 0002 83B0     		sub	sp, sp, #12
  75              	.LCFI2:
  76              		.cfi_def_cfa_offset 32
  77 0004 0191     		str	r1, [sp, #4]
 198:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_CPSR_ALLOC();
  78              		.loc 1 198 5 is_stmt 1 view .LVU9
  79              	.LVL4:
 199:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
  80              		.loc 1 199 5 view .LVU10
 200:..//kernel/core/tos_priority_message_queue.c ****     k_task_t *task, *tmp;
  81              		.loc 1 200 5 view .LVU11
 201:..//kernel/core/tos_priority_message_queue.c **** 
 202:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
  82              		.loc 1 202 5 view .LVU12
  83              		.loc 1 202 5 view .LVU13
  84 0006 0028     		cmp	r0, #0
  85 0008 43D0     		beq	.L11
  86 000a 0446     		mov	r4, r0
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 6


 203:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
  87              		.loc 1 203 5 view .LVU14
  88              		.loc 1 203 5 view .LVU15
  89              	.LVL5:
  90              	.LBB32:
  91              	.LBI32:
  92              		.file 2 "..//kernel/core/include/tos_sys.h"
   1:..//kernel/core/include/tos_sys.h **** /*----------------------------------------------------------------------------
   2:..//kernel/core/include/tos_sys.h ****  * Tencent is pleased to support the open source community by making TencentOS
   3:..//kernel/core/include/tos_sys.h ****  * available.
   4:..//kernel/core/include/tos_sys.h ****  *
   5:..//kernel/core/include/tos_sys.h ****  * Copyright (C) 2019 THL A29 Limited, a Tencent company. All rights reserved.
   6:..//kernel/core/include/tos_sys.h ****  * If you have downloaded a copy of the TencentOS binary from Tencent, please
   7:..//kernel/core/include/tos_sys.h ****  * note that the TencentOS binary is licensed under the BSD 3-Clause License.
   8:..//kernel/core/include/tos_sys.h ****  *
   9:..//kernel/core/include/tos_sys.h ****  * If you have downloaded a copy of the TencentOS source code from Tencent,
  10:..//kernel/core/include/tos_sys.h ****  * please note that TencentOS source code is licensed under the BSD 3-Clause
  11:..//kernel/core/include/tos_sys.h ****  * License, except for the third-party components listed below which are
  12:..//kernel/core/include/tos_sys.h ****  * subject to different license terms. Your integration of TencentOS into your
  13:..//kernel/core/include/tos_sys.h ****  * own projects may require compliance with the BSD 3-Clause License, as well
  14:..//kernel/core/include/tos_sys.h ****  * as the other licenses applicable to the third-party components included
  15:..//kernel/core/include/tos_sys.h ****  * within TencentOS.
  16:..//kernel/core/include/tos_sys.h ****  *---------------------------------------------------------------------------*/
  17:..//kernel/core/include/tos_sys.h **** 
  18:..//kernel/core/include/tos_sys.h **** #ifndef _TOS_SYS_H_
  19:..//kernel/core/include/tos_sys.h **** #define  _TOS_SYS_H_
  20:..//kernel/core/include/tos_sys.h **** 
  21:..//kernel/core/include/tos_sys.h **** __CDECLS_BEGIN
  22:..//kernel/core/include/tos_sys.h **** 
  23:..//kernel/core/include/tos_sys.h **** #define K_NESTING_LIMIT_IRQ             (k_nesting_t)250u
  24:..//kernel/core/include/tos_sys.h **** #define K_NESTING_LIMIT_SCHED_LOCK      (k_nesting_t)250u
  25:..//kernel/core/include/tos_sys.h **** 
  26:..//kernel/core/include/tos_sys.h **** typedef enum knl_state_en {
  27:..//kernel/core/include/tos_sys.h ****     KNL_STATE_STOPPED,
  28:..//kernel/core/include/tos_sys.h ****     KNL_STATE_RUNNING,
  29:..//kernel/core/include/tos_sys.h **** } knl_state_t;
  30:..//kernel/core/include/tos_sys.h **** 
  31:..//kernel/core/include/tos_sys.h **** // some kind of magic number, mainly for identifing whether the object is initialized, or whether u
  32:..//kernel/core/include/tos_sys.h **** typedef enum knl_obj_type_en {
  33:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_NONE                           = 0x0000,
  34:..//kernel/core/include/tos_sys.h **** 
  35:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_BINARY_HEAP                    = 0xDAD0,
  36:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_BITMAP                         = 0xDAD1,
  37:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_CHAR_FIFO                      = 0xDAD2,
  38:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_MMBLK_POOL                     = 0xDAD3,
  39:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_MSG_QUEUE                      = 0xDAD4,
  40:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_PRIORITY_QUEUE                 = 0xDAD5,
  41:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_RING_QUEUE                     = 0xDAD6,
  42:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_STOPWATCH                      = 0xDAD7,
  43:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_TASK                           = 0xDAD8,
  44:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_TIMER                          = 0xDAD9,
  45:..//kernel/core/include/tos_sys.h **** 
  46:..//kernel/core/include/tos_sys.h ****     // ipc object
  47:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_BARRIER                        = 0x0BEE,
  48:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_COMPLETION                     = 0x1BEE,
  49:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_COUNTDOWNLATCH                 = 0x2BEE,
  50:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_EVENT                          = 0x3BEE,
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 7


  51:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_MAIL_QUEUE                     = 0x4BEE,
  52:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_MESSAGE_QUEUE                  = 0x5BEE,
  53:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_MUTEX                          = 0x6BEE,
  54:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_PRIORITY_MAIL_QUEUE            = 0x7BEE,
  55:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE         = 0x8BEE,
  56:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_RWLOCK                         = 0x9BEE,
  57:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_TYPE_SEMAPHORE                      = 0xABEE,
  58:..//kernel/core/include/tos_sys.h **** } knl_obj_type_t;
  59:..//kernel/core/include/tos_sys.h **** 
  60:..//kernel/core/include/tos_sys.h **** typedef enum knl_obj_alloc_type_en {
  61:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_ALLOC_TYPE_NONE,
  62:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_ALLOC_TYPE_STATIC,
  63:..//kernel/core/include/tos_sys.h ****     KNL_OBJ_ALLOC_TYPE_DYNAMIC,
  64:..//kernel/core/include/tos_sys.h **** } knl_obj_alloc_type_t;
  65:..//kernel/core/include/tos_sys.h **** 
  66:..//kernel/core/include/tos_sys.h **** typedef struct knl_object_st {
  67:..//kernel/core/include/tos_sys.h ****     knl_obj_alloc_type_t    alloc_type; /* is dynamic allocated(using tos_mmheap) or static memory?
  68:..//kernel/core/include/tos_sys.h **** #if TOS_CFG_OBJECT_VERIFY_EN > 0u
  69:..//kernel/core/include/tos_sys.h ****     knl_obj_type_t          type;
  70:..//kernel/core/include/tos_sys.h **** #endif
  71:..//kernel/core/include/tos_sys.h **** } knl_obj_t;
  72:..//kernel/core/include/tos_sys.h **** 
  73:..//kernel/core/include/tos_sys.h **** /**
  74:..//kernel/core/include/tos_sys.h ****  * @brief Initialize the kernel.
  75:..//kernel/core/include/tos_sys.h ****  * initialize the tos tiny kernel.
  76:..//kernel/core/include/tos_sys.h ****  *
  77:..//kernel/core/include/tos_sys.h ****  * @attention None
  78:..//kernel/core/include/tos_sys.h ****  *
  79:..//kernel/core/include/tos_sys.h ****  * @param   None
  80:..//kernel/core/include/tos_sys.h ****  *
  81:..//kernel/core/include/tos_sys.h ****  * @return  errcode
  82:..//kernel/core/include/tos_sys.h ****  * @retval  Non-#K_ERR_NONE               return failed.
  83:..//kernel/core/include/tos_sys.h ****  * @retval  #K_ERR_NONE                   return successfully.
  84:..//kernel/core/include/tos_sys.h ****  */
  85:..//kernel/core/include/tos_sys.h **** __API__ k_err_t tos_knl_init(void);
  86:..//kernel/core/include/tos_sys.h **** 
  87:..//kernel/core/include/tos_sys.h **** /**
  88:..//kernel/core/include/tos_sys.h ****  * @brief Start the kernel.
  89:..//kernel/core/include/tos_sys.h ****  * get the kernel start to run, which means start the multitask scheduling.
  90:..//kernel/core/include/tos_sys.h ****  *
  91:..//kernel/core/include/tos_sys.h ****  * @attention None
  92:..//kernel/core/include/tos_sys.h ****  *
  93:..//kernel/core/include/tos_sys.h ****  * @param   None
  94:..//kernel/core/include/tos_sys.h ****  *
  95:..//kernel/core/include/tos_sys.h ****  * @return  errcode
  96:..//kernel/core/include/tos_sys.h ****  * @retval  #K_ERR_KNL_RUNNING            the kernel is already running.
  97:..//kernel/core/include/tos_sys.h ****  * @retval  #K_ERR_NONE                   return successfully.
  98:..//kernel/core/include/tos_sys.h ****  */
  99:..//kernel/core/include/tos_sys.h **** __API__ k_err_t tos_knl_start(void);
 100:..//kernel/core/include/tos_sys.h **** 
 101:..//kernel/core/include/tos_sys.h **** /**
 102:..//kernel/core/include/tos_sys.h ****  * @brief Get the kernel state.
 103:..//kernel/core/include/tos_sys.h ****  * whether the kernel is running.
 104:..//kernel/core/include/tos_sys.h ****  *
 105:..//kernel/core/include/tos_sys.h ****  * @attention None
 106:..//kernel/core/include/tos_sys.h ****  *
 107:..//kernel/core/include/tos_sys.h ****  * @param   None
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 8


 108:..//kernel/core/include/tos_sys.h ****  *
 109:..//kernel/core/include/tos_sys.h ****  * @return  whether the kernel is running.
 110:..//kernel/core/include/tos_sys.h ****  * @retval  Non-0                           the kernel is running.
 111:..//kernel/core/include/tos_sys.h ****  * @retval  0                               the kernel is not running.
 112:..//kernel/core/include/tos_sys.h ****  */
 113:..//kernel/core/include/tos_sys.h **** __API__ int     tos_knl_is_running(void);
 114:..//kernel/core/include/tos_sys.h **** 
 115:..//kernel/core/include/tos_sys.h **** /**
 116:..//kernel/core/include/tos_sys.h ****  * @brief Kernel enter the interrupt.
 117:..//kernel/core/include/tos_sys.h ****  * this function should be called in the entrance of a interrupt handler.
 118:..//kernel/core/include/tos_sys.h ****  *
 119:..//kernel/core/include/tos_sys.h ****  * @attention None
 120:..//kernel/core/include/tos_sys.h ****  *
 121:..//kernel/core/include/tos_sys.h ****  * @param   None
 122:..//kernel/core/include/tos_sys.h ****  *
 123:..//kernel/core/include/tos_sys.h ****  * @return  None
 124:..//kernel/core/include/tos_sys.h ****  */
 125:..//kernel/core/include/tos_sys.h **** __API__ void    tos_knl_irq_enter(void);
 126:..//kernel/core/include/tos_sys.h **** 
 127:..//kernel/core/include/tos_sys.h **** /**
 128:..//kernel/core/include/tos_sys.h ****  * @brief Kernel exit the interrupt.
 129:..//kernel/core/include/tos_sys.h ****  * this function should be called in the exit of a interrupt handler.
 130:..//kernel/core/include/tos_sys.h ****  *
 131:..//kernel/core/include/tos_sys.h ****  * @attention None
 132:..//kernel/core/include/tos_sys.h ****  *
 133:..//kernel/core/include/tos_sys.h ****  * @param   None
 134:..//kernel/core/include/tos_sys.h ****  *
 135:..//kernel/core/include/tos_sys.h ****  * @return  None
 136:..//kernel/core/include/tos_sys.h ****  */
 137:..//kernel/core/include/tos_sys.h **** __API__ void    tos_knl_irq_leave(void);
 138:..//kernel/core/include/tos_sys.h **** 
 139:..//kernel/core/include/tos_sys.h **** /**
 140:..//kernel/core/include/tos_sys.h ****  * @brief Lock the scheduler.
 141:..//kernel/core/include/tos_sys.h ****  * prevent the kernel from performing task schedule.
 142:..//kernel/core/include/tos_sys.h ****  *
 143:..//kernel/core/include/tos_sys.h ****  * @attention None
 144:..//kernel/core/include/tos_sys.h ****  *
 145:..//kernel/core/include/tos_sys.h ****  * @param   None
 146:..//kernel/core/include/tos_sys.h ****  *
 147:..//kernel/core/include/tos_sys.h ****  * @return  errcode
 148:..//kernel/core/include/tos_sys.h ****  * @retval  K_ERR_KNL_NOT_RUNNING         the kernel is not running.
 149:..//kernel/core/include/tos_sys.h ****  * @retval  K_ERR_LOCK_NESTING_OVERFLOW   the schedule lock nesting is overflow.
 150:..//kernel/core/include/tos_sys.h ****  * @retval  K_ERR_NONE                    return successfully.
 151:..//kernel/core/include/tos_sys.h ****  */
 152:..//kernel/core/include/tos_sys.h **** __API__ k_err_t tos_knl_sched_lock(void);
 153:..//kernel/core/include/tos_sys.h **** 
 154:..//kernel/core/include/tos_sys.h **** /**
 155:..//kernel/core/include/tos_sys.h ****  * @brief Unlock the scheduler.
 156:..//kernel/core/include/tos_sys.h ****  * re-enable the task schedule.
 157:..//kernel/core/include/tos_sys.h ****  *
 158:..//kernel/core/include/tos_sys.h ****  * @attention None
 159:..//kernel/core/include/tos_sys.h ****  *
 160:..//kernel/core/include/tos_sys.h ****  * @param   None
 161:..//kernel/core/include/tos_sys.h ****  *
 162:..//kernel/core/include/tos_sys.h ****  * @return  errcode
 163:..//kernel/core/include/tos_sys.h ****  * @retval  K_ERR_KNL_NOT_RUNNING         the kernel is not running.
 164:..//kernel/core/include/tos_sys.h ****  * @retval  K_ERR_SCHED_NOT_LOCKED        the scheduler is not locked.
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 9


 165:..//kernel/core/include/tos_sys.h ****  * @retval  K_ERR_NONE                    return successfully.
 166:..//kernel/core/include/tos_sys.h ****  */
 167:..//kernel/core/include/tos_sys.h **** __API__ k_err_t tos_knl_sched_unlock(void);
 168:..//kernel/core/include/tos_sys.h **** 
 169:..//kernel/core/include/tos_sys.h **** #if TOS_CFG_TICKLESS_EN > 0u
 170:..//kernel/core/include/tos_sys.h **** __KNL__ k_tick_t knl_next_expires_get(void);
 171:..//kernel/core/include/tos_sys.h **** #endif
 172:..//kernel/core/include/tos_sys.h **** 
 173:..//kernel/core/include/tos_sys.h **** __KNL__ void    knl_sched(void);
 174:..//kernel/core/include/tos_sys.h **** __KNL__ int     knl_is_sched_locked(void);
 175:..//kernel/core/include/tos_sys.h **** __KNL__ int     knl_is_inirq(void);
 176:..//kernel/core/include/tos_sys.h **** __KNL__ int     knl_is_idle(k_task_t *task);
 177:..//kernel/core/include/tos_sys.h **** __KNL__ int     knl_is_self(k_task_t *task);
 178:..//kernel/core/include/tos_sys.h **** __KNL__ k_err_t knl_idle_init(void);
 179:..//kernel/core/include/tos_sys.h **** 
 180:..//kernel/core/include/tos_sys.h **** #if TOS_CFG_OBJECT_VERIFY_EN > 0u
 181:..//kernel/core/include/tos_sys.h **** 
 182:..//kernel/core/include/tos_sys.h **** __KNL__ __STATIC_INLINE__ int knl_object_verify(knl_obj_t *knl_obj, knl_obj_type_t type)
  93              		.loc 2 182 31 view .LVU16
  94              	.LBB33:
 183:..//kernel/core/include/tos_sys.h **** {
 184:..//kernel/core/include/tos_sys.h ****     return knl_obj->type == type;
  95              		.loc 2 184 5 view .LVU17
  96              		.loc 2 184 19 is_stmt 0 view .LVU18
  97 000c 4088     		ldrh	r0, [r0, #2]
  98              	.LVL6:
  99              		.loc 2 184 19 view .LVU19
 100              	.LBE33:
 101              	.LBE32:
 102              		.loc 1 203 5 view .LVU20
 103 000e 48F6EE31 		movw	r1, #35822
 104              	.LVL7:
 105              		.loc 1 203 5 view .LVU21
 106 0012 8842     		cmp	r0, r1
 107 0014 04D0     		beq	.L14
 108 0016 40F24D44 		movw	r4, #1101
 109              	.LVL8:
 110              	.L4:
 204:..//kernel/core/tos_priority_message_queue.c **** 
 205:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_INT_DISABLE();
 206:..//kernel/core/tos_priority_message_queue.c **** 
 207:..//kernel/core/tos_priority_message_queue.c ****     if (pend_is_nopending(&prio_msg_q->pend_obj)) {
 208:..//kernel/core/tos_priority_message_queue.c ****         err = tos_prio_q_enqueue(&prio_msg_q->prio_q, &msg_ptr, sizeof(void *), prio);
 209:..//kernel/core/tos_priority_message_queue.c ****         if (err != K_ERR_NONE) {
 210:..//kernel/core/tos_priority_message_queue.c ****             TOS_CPU_INT_ENABLE();
 211:..//kernel/core/tos_priority_message_queue.c ****             return err;
 212:..//kernel/core/tos_priority_message_queue.c ****         }
 213:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 214:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_NONE;
 215:..//kernel/core/tos_priority_message_queue.c ****     }
 216:..//kernel/core/tos_priority_message_queue.c **** 
 217:..//kernel/core/tos_priority_message_queue.c ****     if (opt == OPT_POST_ONE) {
 218:..//kernel/core/tos_priority_message_queue.c ****         prio_msg_q_task_recv(TOS_LIST_FIRST_ENTRY(&prio_msg_q->pend_obj.list, k_task_t, pend_list),
 219:..//kernel/core/tos_priority_message_queue.c ****     } else { // OPT_POST_ALL
 220:..//kernel/core/tos_priority_message_queue.c ****         TOS_LIST_FOR_EACH_ENTRY_SAFE(task, tmp, k_task_t, pend_list, &prio_msg_q->pend_obj.list) {
 221:..//kernel/core/tos_priority_message_queue.c ****             prio_msg_q_task_recv(task, msg_ptr);
 222:..//kernel/core/tos_priority_message_queue.c ****         }
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 10


 223:..//kernel/core/tos_priority_message_queue.c ****     }
 224:..//kernel/core/tos_priority_message_queue.c **** 
 225:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_INT_ENABLE();
 226:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 227:..//kernel/core/tos_priority_message_queue.c **** 
 228:..//kernel/core/tos_priority_message_queue.c ****     return K_ERR_NONE;
 229:..//kernel/core/tos_priority_message_queue.c **** }
 111              		.loc 1 229 1 view .LVU22
 112 001a 2046     		mov	r0, r4
 113 001c 03B0     		add	sp, sp, #12
 114              	.LCFI3:
 115              		.cfi_remember_state
 116              		.cfi_def_cfa_offset 20
 117              		@ sp needed
 118 001e F0BD     		pop	{r4, r5, r6, r7, pc}
 119              	.LVL9:
 120              	.L14:
 121              	.LCFI4:
 122              		.cfi_restore_state
 123              		.loc 1 229 1 view .LVU23
 124 0020 1D46     		mov	r5, r3
 125 0022 1746     		mov	r7, r2
 205:..//kernel/core/tos_priority_message_queue.c **** 
 126              		.loc 1 205 5 is_stmt 1 view .LVU24
 205:..//kernel/core/tos_priority_message_queue.c **** 
 127              		.loc 1 205 5 view .LVU25
 128 0024 FFF7FEFF 		bl	tos_cpu_cpsr_save
 129              	.LVL10:
 205:..//kernel/core/tos_priority_message_queue.c **** 
 130              		.loc 1 205 5 is_stmt 0 view .LVU26
 131 0028 0646     		mov	r6, r0
 132              	.LVL11:
 207:..//kernel/core/tos_priority_message_queue.c ****         err = tos_prio_q_enqueue(&prio_msg_q->prio_q, &msg_ptr, sizeof(void *), prio);
 133              		.loc 1 207 5 is_stmt 1 view .LVU27
 207:..//kernel/core/tos_priority_message_queue.c ****         err = tos_prio_q_enqueue(&prio_msg_q->prio_q, &msg_ptr, sizeof(void *), prio);
 134              		.loc 1 207 9 is_stmt 0 view .LVU28
 135 002a 201D     		adds	r0, r4, #4
 136              	.LVL12:
 207:..//kernel/core/tos_priority_message_queue.c ****         err = tos_prio_q_enqueue(&prio_msg_q->prio_q, &msg_ptr, sizeof(void *), prio);
 137              		.loc 1 207 9 view .LVU29
 138 002c FFF7FEFF 		bl	pend_is_nopending
 139              	.LVL13:
 207:..//kernel/core/tos_priority_message_queue.c ****         err = tos_prio_q_enqueue(&prio_msg_q->prio_q, &msg_ptr, sizeof(void *), prio);
 140              		.loc 1 207 8 view .LVU30
 141 0030 88B9     		cbnz	r0, .L15
 217:..//kernel/core/tos_priority_message_queue.c ****         prio_msg_q_task_recv(TOS_LIST_FIRST_ENTRY(&prio_msg_q->pend_obj.list, k_task_t, pend_list),
 142              		.loc 1 217 5 is_stmt 1 view .LVU31
 217:..//kernel/core/tos_priority_message_queue.c ****         prio_msg_q_task_recv(TOS_LIST_FIRST_ENTRY(&prio_msg_q->pend_obj.list, k_task_t, pend_list),
 143              		.loc 1 217 8 is_stmt 0 view .LVU32
 144 0032 15B3     		cbz	r5, .L16
 220:..//kernel/core/tos_priority_message_queue.c ****             prio_msg_q_task_recv(task, msg_ptr);
 145              		.loc 1 220 9 is_stmt 1 view .LVU33
 146 0034 6068     		ldr	r0, [r4, #4]
 147              	.LVL14:
 220:..//kernel/core/tos_priority_message_queue.c ****             prio_msg_q_task_recv(task, msg_ptr);
 148              		.loc 1 220 9 is_stmt 0 view .LVU34
 149 0036 50F85059 		ldr	r5, [r0], #-80
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 11


 150              	.LVL15:
 220:..//kernel/core/tos_priority_message_queue.c ****             prio_msg_q_task_recv(task, msg_ptr);
 151              		.loc 1 220 9 view .LVU35
 152 003a 503D     		subs	r5, r5, #80
 153              	.LVL16:
 154              	.L9:
 220:..//kernel/core/tos_priority_message_queue.c ****             prio_msg_q_task_recv(task, msg_ptr);
 155              		.loc 1 220 9 discriminator 1 view .LVU36
 156 003c 00F15003 		add	r3, r0, #80
 157 0040 221D     		adds	r2, r4, #4
 158 0042 9342     		cmp	r3, r2
 159 0044 1ED0     		beq	.L8
 221:..//kernel/core/tos_priority_message_queue.c ****         }
 160              		.loc 1 221 13 is_stmt 1 discriminator 3 view .LVU37
 161 0046 0199     		ldr	r1, [sp, #4]
 162 0048 FFF7FEFF 		bl	prio_msg_q_task_recv
 163              	.LVL17:
 220:..//kernel/core/tos_priority_message_queue.c ****             prio_msg_q_task_recv(task, msg_ptr);
 164              		.loc 1 220 9 is_stmt 0 discriminator 3 view .LVU38
 165 004c 2B6D     		ldr	r3, [r5, #80]
 166              	.LVL18:
 220:..//kernel/core/tos_priority_message_queue.c ****             prio_msg_q_task_recv(task, msg_ptr);
 167              		.loc 1 220 9 discriminator 3 view .LVU39
 168 004e 2846     		mov	r0, r5
 169 0050 A3F15005 		sub	r5, r3, #80
 170              	.LVL19:
 220:..//kernel/core/tos_priority_message_queue.c ****             prio_msg_q_task_recv(task, msg_ptr);
 171              		.loc 1 220 9 discriminator 3 view .LVU40
 172 0054 F2E7     		b	.L9
 173              	.LVL20:
 174              	.L15:
 208:..//kernel/core/tos_priority_message_queue.c ****         if (err != K_ERR_NONE) {
 175              		.loc 1 208 9 is_stmt 1 view .LVU41
 208:..//kernel/core/tos_priority_message_queue.c ****         if (err != K_ERR_NONE) {
 176              		.loc 1 208 15 is_stmt 0 view .LVU42
 177 0056 3B46     		mov	r3, r7
 178 0058 0422     		movs	r2, #4
 179 005a 0DEB0201 		add	r1, sp, r2
 180 005e 04F11000 		add	r0, r4, #16
 181 0062 FFF7FEFF 		bl	tos_prio_q_enqueue
 182              	.LVL21:
 209:..//kernel/core/tos_priority_message_queue.c ****             TOS_CPU_INT_ENABLE();
 183              		.loc 1 209 9 is_stmt 1 view .LVU43
 209:..//kernel/core/tos_priority_message_queue.c ****             TOS_CPU_INT_ENABLE();
 184              		.loc 1 209 12 is_stmt 0 view .LVU44
 185 0066 0446     		mov	r4, r0
 186              	.LVL22:
 209:..//kernel/core/tos_priority_message_queue.c ****             TOS_CPU_INT_ENABLE();
 187              		.loc 1 209 12 view .LVU45
 188 0068 18B1     		cbz	r0, .L6
 210:..//kernel/core/tos_priority_message_queue.c ****             return err;
 189              		.loc 1 210 13 is_stmt 1 view .LVU46
 210:..//kernel/core/tos_priority_message_queue.c ****             return err;
 190              		.loc 1 210 13 view .LVU47
 191 006a 3046     		mov	r0, r6
 192              	.LVL23:
 210:..//kernel/core/tos_priority_message_queue.c ****             return err;
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 12


 193              		.loc 1 210 13 is_stmt 0 view .LVU48
 194 006c FFF7FEFF 		bl	tos_cpu_cpsr_restore
 195              	.LVL24:
 211:..//kernel/core/tos_priority_message_queue.c ****         }
 196              		.loc 1 211 13 is_stmt 1 view .LVU49
 211:..//kernel/core/tos_priority_message_queue.c ****         }
 197              		.loc 1 211 20 is_stmt 0 view .LVU50
 198 0070 D3E7     		b	.L4
 199              	.LVL25:
 200              	.L6:
 213:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_NONE;
 201              		.loc 1 213 9 is_stmt 1 view .LVU51
 213:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_NONE;
 202              		.loc 1 213 9 view .LVU52
 203 0072 3046     		mov	r0, r6
 204              	.LVL26:
 213:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_NONE;
 205              		.loc 1 213 9 is_stmt 0 view .LVU53
 206 0074 FFF7FEFF 		bl	tos_cpu_cpsr_restore
 207              	.LVL27:
 214:..//kernel/core/tos_priority_message_queue.c ****     }
 208              		.loc 1 214 9 is_stmt 1 view .LVU54
 214:..//kernel/core/tos_priority_message_queue.c ****     }
 209              		.loc 1 214 16 is_stmt 0 view .LVU55
 210 0078 CFE7     		b	.L4
 211              	.LVL28:
 212              	.L16:
 218:..//kernel/core/tos_priority_message_queue.c ****     } else { // OPT_POST_ALL
 213              		.loc 1 218 9 is_stmt 1 view .LVU56
 218:..//kernel/core/tos_priority_message_queue.c ****     } else { // OPT_POST_ALL
 214              		.loc 1 218 30 is_stmt 0 view .LVU57
 215 007a 6068     		ldr	r0, [r4, #4]
 218:..//kernel/core/tos_priority_message_queue.c ****     } else { // OPT_POST_ALL
 216              		.loc 1 218 9 view .LVU58
 217 007c 0199     		ldr	r1, [sp, #4]
 218 007e 5038     		subs	r0, r0, #80
 219 0080 FFF7FEFF 		bl	prio_msg_q_task_recv
 220              	.LVL29:
 221              	.L8:
 225:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 222              		.loc 1 225 5 is_stmt 1 view .LVU59
 225:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 223              		.loc 1 225 5 view .LVU60
 224 0084 3046     		mov	r0, r6
 225 0086 FFF7FEFF 		bl	tos_cpu_cpsr_restore
 226              	.LVL30:
 226:..//kernel/core/tos_priority_message_queue.c **** 
 227              		.loc 1 226 5 view .LVU61
 228 008a FFF7FEFF 		bl	knl_sched
 229              	.LVL31:
 228:..//kernel/core/tos_priority_message_queue.c **** }
 230              		.loc 1 228 5 view .LVU62
 228:..//kernel/core/tos_priority_message_queue.c **** }
 231              		.loc 1 228 12 is_stmt 0 view .LVU63
 232 008e 0024     		movs	r4, #0
 233              	.LVL32:
 228:..//kernel/core/tos_priority_message_queue.c **** }
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 13


 234              		.loc 1 228 12 view .LVU64
 235 0090 C3E7     		b	.L4
 236              	.LVL33:
 237              	.L11:
 202:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 238              		.loc 1 202 5 view .LVU65
 239 0092 40F24C44 		movw	r4, #1100
 240 0096 C0E7     		b	.L4
 241              		.cfi_endproc
 242              	.LFE117:
 244              		.section	.text.tos_prio_msg_q_create,"ax",%progbits
 245              		.align	1
 246              		.global	tos_prio_msg_q_create
 247              		.syntax unified
 248              		.thumb
 249              		.thumb_func
 250              		.fpu softvfp
 252              	tos_prio_msg_q_create:
 253              	.LVL34:
 254              	.LFB110:
  23:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
 255              		.loc 1 23 1 is_stmt 1 view -0
 256              		.cfi_startproc
 257              		@ args = 0, pretend = 0, frame = 0
 258              		@ frame_needed = 0, uses_anonymous_args = 0
  23:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
 259              		.loc 1 23 1 is_stmt 0 view .LVU67
 260 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 261              	.LCFI5:
 262              		.cfi_def_cfa_offset 20
 263              		.cfi_offset 4, -20
 264              		.cfi_offset 5, -16
 265              		.cfi_offset 6, -12
 266              		.cfi_offset 7, -8
 267              		.cfi_offset 14, -4
 268 0002 83B0     		sub	sp, sp, #12
 269              	.LCFI6:
 270              		.cfi_def_cfa_offset 32
  24:..//kernel/core/tos_priority_message_queue.c ****     void *prio_q_mgr_array = K_NULL;
 271              		.loc 1 24 5 is_stmt 1 view .LVU68
  25:..//kernel/core/tos_priority_message_queue.c **** 
 272              		.loc 1 25 5 view .LVU69
 273              	.LVL35:
  27:..//kernel/core/tos_priority_message_queue.c **** 
 274              		.loc 1 27 5 view .LVU70
  27:..//kernel/core/tos_priority_message_queue.c **** 
 275              		.loc 1 27 5 view .LVU71
 276 0004 20B3     		cbz	r0, .L20
 277 0006 0446     		mov	r4, r0
 278 0008 1546     		mov	r5, r2
 279 000a 0E46     		mov	r6, r1
  29:..//kernel/core/tos_priority_message_queue.c ****     if (!prio_q_mgr_array) {
 280              		.loc 1 29 5 view .LVU72
  29:..//kernel/core/tos_priority_message_queue.c ****     if (!prio_q_mgr_array) {
 281              		.loc 1 29 24 is_stmt 0 view .LVU73
 282 000c 02EB4203 		add	r3, r2, r2, lsl #1
 283 0010 5800     		lsls	r0, r3, #1
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 14


 284              	.LVL36:
  29:..//kernel/core/tos_priority_message_queue.c ****     if (!prio_q_mgr_array) {
 285              		.loc 1 29 24 view .LVU74
 286 0012 FFF7FEFF 		bl	tos_mmheap_alloc
 287              	.LVL37:
  30:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_OUT_OF_MEMORY;
 288              		.loc 1 30 5 is_stmt 1 view .LVU75
  30:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_OUT_OF_MEMORY;
 289              		.loc 1 30 8 is_stmt 0 view .LVU76
 290 0016 0746     		mov	r7, r0
 291 0018 E8B1     		cbz	r0, .L21
  34:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 292              		.loc 1 34 5 is_stmt 1 view .LVU77
  34:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 293              		.loc 1 34 11 is_stmt 0 view .LVU78
 294 001a 0423     		movs	r3, #4
 295 001c 0093     		str	r3, [sp]
 296 001e 2B46     		mov	r3, r5
 297 0020 3246     		mov	r2, r6
 298 0022 0146     		mov	r1, r0
 299 0024 04F11000 		add	r0, r4, #16
 300              	.LVL38:
  34:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 301              		.loc 1 34 11 view .LVU79
 302 0028 FFF7FEFF 		bl	tos_prio_q_create
 303              	.LVL39:
  35:..//kernel/core/tos_priority_message_queue.c ****         tos_mmheap_free(prio_q_mgr_array);
 304              		.loc 1 35 5 is_stmt 1 view .LVU80
  35:..//kernel/core/tos_priority_message_queue.c ****         tos_mmheap_free(prio_q_mgr_array);
 305              		.loc 1 35 8 is_stmt 0 view .LVU81
 306 002c 0546     		mov	r5, r0
 307              	.LVL40:
  35:..//kernel/core/tos_priority_message_queue.c ****         tos_mmheap_free(prio_q_mgr_array);
 308              		.loc 1 35 8 view .LVU82
 309 002e 58B9     		cbnz	r0, .L23
  40:..//kernel/core/tos_priority_message_queue.c ****     pend_object_init(&prio_msg_q->pend_obj);
 310              		.loc 1 40 5 is_stmt 1 view .LVU83
  40:..//kernel/core/tos_priority_message_queue.c ****     pend_object_init(&prio_msg_q->pend_obj);
 311              		.loc 1 40 34 is_stmt 0 view .LVU84
 312 0030 E760     		str	r7, [r4, #12]
  41:..//kernel/core/tos_priority_message_queue.c **** 
 313              		.loc 1 41 5 is_stmt 1 view .LVU85
 314 0032 201D     		adds	r0, r4, #4
 315              	.LVL41:
  41:..//kernel/core/tos_priority_message_queue.c **** 
 316              		.loc 1 41 5 is_stmt 0 view .LVU86
 317 0034 FFF7FEFF 		bl	pend_object_init
 318              	.LVL42:
  43:..//kernel/core/tos_priority_message_queue.c ****     knl_object_alloc_set_static(&prio_msg_q->knl_obj);
 319              		.loc 1 43 5 is_stmt 1 view .LVU87
 320              	.LBB34:
 321              	.LBI34:
 185:..//kernel/core/include/tos_sys.h **** }
 186:..//kernel/core/include/tos_sys.h **** 
 187:..//kernel/core/include/tos_sys.h **** __KNL__ __STATIC_INLINE__ void knl_object_init(knl_obj_t *knl_obj, knl_obj_type_t type)
 322              		.loc 2 187 32 view .LVU88
 323              	.LBB35:
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 15


 188:..//kernel/core/include/tos_sys.h **** {
 189:..//kernel/core/include/tos_sys.h ****     knl_obj->type = type;
 324              		.loc 2 189 5 view .LVU89
 325              		.loc 2 189 19 is_stmt 0 view .LVU90
 326 0038 48F6EE33 		movw	r3, #35822
 327 003c 6380     		strh	r3, [r4, #2]	@ movhi
 328              	.LVL43:
 329              		.loc 2 189 19 view .LVU91
 330              	.LBE35:
 331              	.LBE34:
  44:..//kernel/core/tos_priority_message_queue.c **** 
 332              		.loc 1 44 5 is_stmt 1 view .LVU92
 333              	.LBB36:
 334              	.LBI36:
 190:..//kernel/core/include/tos_sys.h **** }
 191:..//kernel/core/include/tos_sys.h **** 
 192:..//kernel/core/include/tos_sys.h **** __KNL__ __STATIC_INLINE__ void knl_object_deinit(knl_obj_t *knl_obj)
 193:..//kernel/core/include/tos_sys.h **** {
 194:..//kernel/core/include/tos_sys.h ****     knl_obj->type = KNL_OBJ_TYPE_NONE;
 195:..//kernel/core/include/tos_sys.h **** }
 196:..//kernel/core/include/tos_sys.h **** 
 197:..//kernel/core/include/tos_sys.h **** #endif
 198:..//kernel/core/include/tos_sys.h **** 
 199:..//kernel/core/include/tos_sys.h **** __KNL__ __STATIC_INLINE__ void knl_object_alloc_reset(knl_obj_t *knl_obj)
 200:..//kernel/core/include/tos_sys.h **** {
 201:..//kernel/core/include/tos_sys.h ****     knl_obj->alloc_type = KNL_OBJ_ALLOC_TYPE_NONE;
 202:..//kernel/core/include/tos_sys.h **** }
 203:..//kernel/core/include/tos_sys.h **** 
 204:..//kernel/core/include/tos_sys.h **** __KNL__ __STATIC_INLINE__ void knl_object_alloc_set_dynamic(knl_obj_t *knl_obj)
 205:..//kernel/core/include/tos_sys.h **** {
 206:..//kernel/core/include/tos_sys.h ****     knl_obj->alloc_type = KNL_OBJ_ALLOC_TYPE_DYNAMIC;
 207:..//kernel/core/include/tos_sys.h **** }
 208:..//kernel/core/include/tos_sys.h **** 
 209:..//kernel/core/include/tos_sys.h **** __KNL__ __STATIC_INLINE__ void knl_object_alloc_set_static(knl_obj_t *knl_obj)
 335              		.loc 2 209 32 view .LVU93
 336              	.LBB37:
 210:..//kernel/core/include/tos_sys.h **** {
 211:..//kernel/core/include/tos_sys.h ****     knl_obj->alloc_type = KNL_OBJ_ALLOC_TYPE_STATIC;
 337              		.loc 2 211 5 view .LVU94
 338              		.loc 2 211 25 is_stmt 0 view .LVU95
 339 003e 0123     		movs	r3, #1
 340 0040 2370     		strb	r3, [r4]
 341              	.LVL44:
 342              		.loc 2 211 25 view .LVU96
 343              	.LBE37:
 344              	.LBE36:
  46:..//kernel/core/tos_priority_message_queue.c **** }
 345              		.loc 1 46 5 is_stmt 1 view .LVU97
 346              	.L18:
  47:..//kernel/core/tos_priority_message_queue.c **** 
 347              		.loc 1 47 1 is_stmt 0 view .LVU98
 348 0042 2846     		mov	r0, r5
 349 0044 03B0     		add	sp, sp, #12
 350              	.LCFI7:
 351              		.cfi_remember_state
 352              		.cfi_def_cfa_offset 20
 353              		@ sp needed
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 16


 354 0046 F0BD     		pop	{r4, r5, r6, r7, pc}
 355              	.LVL45:
 356              	.L23:
 357              	.LCFI8:
 358              		.cfi_restore_state
  36:..//kernel/core/tos_priority_message_queue.c ****         return err;
 359              		.loc 1 36 9 is_stmt 1 view .LVU99
 360 0048 3846     		mov	r0, r7
 361              	.LVL46:
  36:..//kernel/core/tos_priority_message_queue.c ****         return err;
 362              		.loc 1 36 9 is_stmt 0 view .LVU100
 363 004a FFF7FEFF 		bl	tos_mmheap_free
 364              	.LVL47:
  37:..//kernel/core/tos_priority_message_queue.c ****     }
 365              		.loc 1 37 9 is_stmt 1 view .LVU101
  37:..//kernel/core/tos_priority_message_queue.c ****     }
 366              		.loc 1 37 16 is_stmt 0 view .LVU102
 367 004e F8E7     		b	.L18
 368              	.LVL48:
 369              	.L20:
  27:..//kernel/core/tos_priority_message_queue.c **** 
 370              		.loc 1 27 5 view .LVU103
 371 0050 40F24C45 		movw	r5, #1100
 372 0054 F5E7     		b	.L18
 373              	.LVL49:
 374              	.L21:
  31:..//kernel/core/tos_priority_message_queue.c ****     }
 375              		.loc 1 31 16 view .LVU104
 376 0056 40F27E45 		movw	r5, #1150
 377              	.LVL50:
  31:..//kernel/core/tos_priority_message_queue.c ****     }
 378              		.loc 1 31 16 view .LVU105
 379 005a F2E7     		b	.L18
 380              		.cfi_endproc
 381              	.LFE110:
 383              		.section	.text.tos_prio_msg_q_destroy,"ax",%progbits
 384              		.align	1
 385              		.global	tos_prio_msg_q_destroy
 386              		.syntax unified
 387              		.thumb
 388              		.thumb_func
 389              		.fpu softvfp
 391              	tos_prio_msg_q_destroy:
 392              	.LVL51:
 393              	.LFB111:
  50:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_CPSR_ALLOC();
 394              		.loc 1 50 1 is_stmt 1 view -0
 395              		.cfi_startproc
 396              		@ args = 0, pretend = 0, frame = 0
 397              		@ frame_needed = 0, uses_anonymous_args = 0
  50:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_CPSR_ALLOC();
 398              		.loc 1 50 1 is_stmt 0 view .LVU107
 399 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 400              	.LCFI9:
 401              		.cfi_def_cfa_offset 24
 402              		.cfi_offset 4, -24
 403              		.cfi_offset 5, -20
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 17


 404              		.cfi_offset 6, -16
 405              		.cfi_offset 7, -12
 406              		.cfi_offset 8, -8
 407              		.cfi_offset 14, -4
  51:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
 408              		.loc 1 51 5 is_stmt 1 view .LVU108
 409              	.LVL52:
  52:..//kernel/core/tos_priority_message_queue.c **** 
 410              		.loc 1 52 5 view .LVU109
  54:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 411              		.loc 1 54 5 view .LVU110
  54:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 412              		.loc 1 54 5 view .LVU111
 413 0004 70B3     		cbz	r0, .L27
 414 0006 0446     		mov	r4, r0
  55:..//kernel/core/tos_priority_message_queue.c **** 
 415              		.loc 1 55 5 view .LVU112
  55:..//kernel/core/tos_priority_message_queue.c **** 
 416              		.loc 1 55 5 view .LVU113
 417              	.LVL53:
 418              	.LBB38:
 419              	.LBI38:
 182:..//kernel/core/include/tos_sys.h **** {
 420              		.loc 2 182 31 view .LVU114
 421              	.LBB39:
 184:..//kernel/core/include/tos_sys.h **** }
 422              		.loc 2 184 5 view .LVU115
 184:..//kernel/core/include/tos_sys.h **** }
 423              		.loc 2 184 19 is_stmt 0 view .LVU116
 424 0008 4188     		ldrh	r1, [r0, #2]
 425              	.LVL54:
 184:..//kernel/core/include/tos_sys.h **** }
 426              		.loc 2 184 19 view .LVU117
 427              	.LBE39:
 428              	.LBE38:
  55:..//kernel/core/tos_priority_message_queue.c **** 
 429              		.loc 1 55 5 view .LVU118
 430 000a 48F6EE32 		movw	r2, #35822
 431 000e 9142     		cmp	r1, r2
 432 0010 2BD1     		bne	.L28
  57:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_OBJ_INVALID_ALLOC_TYPE;
 433              		.loc 1 57 5 is_stmt 1 view .LVU119
 434              	.LVL55:
 435              	.LBB40:
 436              	.LBI40:
 212:..//kernel/core/include/tos_sys.h **** }
 213:..//kernel/core/include/tos_sys.h **** 
 214:..//kernel/core/include/tos_sys.h **** __KNL__ __STATIC_INLINE__ int knl_object_alloc_is_dynamic(knl_obj_t *knl_obj)
 215:..//kernel/core/include/tos_sys.h **** {
 216:..//kernel/core/include/tos_sys.h ****     return knl_obj->alloc_type == KNL_OBJ_ALLOC_TYPE_DYNAMIC;
 217:..//kernel/core/include/tos_sys.h **** }
 218:..//kernel/core/include/tos_sys.h **** 
 219:..//kernel/core/include/tos_sys.h **** __KNL__ __STATIC_INLINE__ int knl_object_alloc_is_static(knl_obj_t *knl_obj)
 437              		.loc 2 219 31 view .LVU120
 438              	.LBB41:
 220:..//kernel/core/include/tos_sys.h **** {
 221:..//kernel/core/include/tos_sys.h ****     return knl_obj->alloc_type == KNL_OBJ_ALLOC_TYPE_STATIC;
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 18


 439              		.loc 2 221 5 view .LVU121
 440              		.loc 2 221 19 is_stmt 0 view .LVU122
 441 0012 0278     		ldrb	r2, [r0]	@ zero_extendqisi2
 442              	.LVL56:
 443              		.loc 2 221 19 view .LVU123
 444              	.LBE41:
 445              	.LBE40:
  57:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_OBJ_INVALID_ALLOC_TYPE;
 446              		.loc 1 57 8 view .LVU124
 447 0014 012A     		cmp	r2, #1
 448 0016 02D0     		beq	.L31
  58:..//kernel/core/tos_priority_message_queue.c ****     }
 449              		.loc 1 58 16 view .LVU125
 450 0018 40F24E45 		movw	r5, #1102
 451 001c 27E0     		b	.L25
 452              	.L31:
  61:..//kernel/core/tos_priority_message_queue.c **** 
 453              		.loc 1 61 5 is_stmt 1 view .LVU126
  61:..//kernel/core/tos_priority_message_queue.c **** 
 454              		.loc 1 61 5 view .LVU127
 455 001e FFF7FEFF 		bl	tos_cpu_cpsr_save
 456              	.LVL57:
  61:..//kernel/core/tos_priority_message_queue.c **** 
 457              		.loc 1 61 5 is_stmt 0 view .LVU128
 458 0022 0746     		mov	r7, r0
 459              	.LVL58:
  63:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 460              		.loc 1 63 5 is_stmt 1 view .LVU129
  63:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 461              		.loc 1 63 11 is_stmt 0 view .LVU130
 462 0024 04F11000 		add	r0, r4, #16
 463              	.LVL59:
  63:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 464              		.loc 1 63 11 view .LVU131
 465 0028 FFF7FEFF 		bl	tos_prio_q_destroy
 466              	.LVL60:
  64:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 467              		.loc 1 64 5 is_stmt 1 view .LVU132
  64:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 468              		.loc 1 64 8 is_stmt 0 view .LVU133
 469 002c 0546     		mov	r5, r0
 470 002e A8B9     		cbnz	r0, .L32
  69:..//kernel/core/tos_priority_message_queue.c **** 
 471              		.loc 1 69 5 is_stmt 1 view .LVU134
 472 0030 04F10408 		add	r8, r4, #4
 473 0034 0321     		movs	r1, #3
 474 0036 4046     		mov	r0, r8
 475              	.LVL61:
  69:..//kernel/core/tos_priority_message_queue.c **** 
 476              		.loc 1 69 5 is_stmt 0 view .LVU135
 477 0038 FFF7FEFF 		bl	pend_wakeup_all
 478              	.LVL62:
  71:..//kernel/core/tos_priority_message_queue.c ****     prio_msg_q->prio_q_mgr_array = K_NULL;
 479              		.loc 1 71 5 is_stmt 1 view .LVU136
 480 003c E068     		ldr	r0, [r4, #12]
 481 003e FFF7FEFF 		bl	tos_mmheap_free
 482              	.LVL63:
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 19


  72:..//kernel/core/tos_priority_message_queue.c **** 
 483              		.loc 1 72 5 view .LVU137
  72:..//kernel/core/tos_priority_message_queue.c **** 
 484              		.loc 1 72 34 is_stmt 0 view .LVU138
 485 0042 0026     		movs	r6, #0
 486 0044 E660     		str	r6, [r4, #12]
  74:..//kernel/core/tos_priority_message_queue.c **** 
 487              		.loc 1 74 5 is_stmt 1 view .LVU139
 488 0046 4046     		mov	r0, r8
 489 0048 FFF7FEFF 		bl	pend_object_deinit
 490              	.LVL64:
  76:..//kernel/core/tos_priority_message_queue.c ****     knl_object_alloc_reset(&prio_msg_q->knl_obj);
 491              		.loc 1 76 5 view .LVU140
 492              	.LBB42:
 493              	.LBI42:
 192:..//kernel/core/include/tos_sys.h **** {
 494              		.loc 2 192 32 view .LVU141
 495              	.LBB43:
 194:..//kernel/core/include/tos_sys.h **** }
 496              		.loc 2 194 5 view .LVU142
 194:..//kernel/core/include/tos_sys.h **** }
 497              		.loc 2 194 19 is_stmt 0 view .LVU143
 498 004c 6680     		strh	r6, [r4, #2]	@ movhi
 499              	.LVL65:
 194:..//kernel/core/include/tos_sys.h **** }
 500              		.loc 2 194 19 view .LVU144
 501              	.LBE43:
 502              	.LBE42:
  77:..//kernel/core/tos_priority_message_queue.c **** 
 503              		.loc 1 77 5 is_stmt 1 view .LVU145
 504              	.LBB44:
 505              	.LBI44:
 199:..//kernel/core/include/tos_sys.h **** {
 506              		.loc 2 199 32 view .LVU146
 507              	.LBB45:
 201:..//kernel/core/include/tos_sys.h **** }
 508              		.loc 2 201 5 view .LVU147
 201:..//kernel/core/include/tos_sys.h **** }
 509              		.loc 2 201 25 is_stmt 0 view .LVU148
 510 004e 2670     		strb	r6, [r4]
 511              	.LVL66:
 201:..//kernel/core/include/tos_sys.h **** }
 512              		.loc 2 201 25 view .LVU149
 513              	.LBE45:
 514              	.LBE44:
  79:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 515              		.loc 1 79 5 is_stmt 1 view .LVU150
  79:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 516              		.loc 1 79 5 view .LVU151
 517 0050 3846     		mov	r0, r7
 518 0052 FFF7FEFF 		bl	tos_cpu_cpsr_restore
 519              	.LVL67:
  80:..//kernel/core/tos_priority_message_queue.c **** 
 520              		.loc 1 80 5 view .LVU152
 521 0056 FFF7FEFF 		bl	knl_sched
 522              	.LVL68:
  82:..//kernel/core/tos_priority_message_queue.c **** }
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 20


 523              		.loc 1 82 5 view .LVU153
  82:..//kernel/core/tos_priority_message_queue.c **** }
 524              		.loc 1 82 12 is_stmt 0 view .LVU154
 525 005a 08E0     		b	.L25
 526              	.LVL69:
 527              	.L32:
  65:..//kernel/core/tos_priority_message_queue.c ****         return err;
 528              		.loc 1 65 9 is_stmt 1 view .LVU155
  65:..//kernel/core/tos_priority_message_queue.c ****         return err;
 529              		.loc 1 65 9 view .LVU156
 530 005c 3846     		mov	r0, r7
 531              	.LVL70:
  65:..//kernel/core/tos_priority_message_queue.c ****         return err;
 532              		.loc 1 65 9 is_stmt 0 view .LVU157
 533 005e FFF7FEFF 		bl	tos_cpu_cpsr_restore
 534              	.LVL71:
  66:..//kernel/core/tos_priority_message_queue.c ****     }
 535              		.loc 1 66 9 is_stmt 1 view .LVU158
  66:..//kernel/core/tos_priority_message_queue.c ****     }
 536              		.loc 1 66 16 is_stmt 0 view .LVU159
 537 0062 04E0     		b	.L25
 538              	.LVL72:
 539              	.L27:
  54:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 540              		.loc 1 54 5 view .LVU160
 541 0064 40F24C45 		movw	r5, #1100
 542 0068 01E0     		b	.L25
 543              	.L28:
  55:..//kernel/core/tos_priority_message_queue.c **** 
 544              		.loc 1 55 5 view .LVU161
 545 006a 40F24D45 		movw	r5, #1101
 546              	.LVL73:
 547              	.L25:
  83:..//kernel/core/tos_priority_message_queue.c **** 
 548              		.loc 1 83 1 view .LVU162
 549 006e 2846     		mov	r0, r5
 550 0070 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 551              		.cfi_endproc
 552              	.LFE111:
 554              		.section	.text.tos_prio_msg_q_create_dyn,"ax",%progbits
 555              		.align	1
 556              		.global	tos_prio_msg_q_create_dyn
 557              		.syntax unified
 558              		.thumb
 559              		.thumb_func
 560              		.fpu softvfp
 562              	tos_prio_msg_q_create_dyn:
 563              	.LVL74:
 564              	.LFB112:
  86:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
 565              		.loc 1 86 1 is_stmt 1 view -0
 566              		.cfi_startproc
 567              		@ args = 0, pretend = 0, frame = 0
 568              		@ frame_needed = 0, uses_anonymous_args = 0
  86:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
 569              		.loc 1 86 1 is_stmt 0 view .LVU164
 570 0000 38B5     		push	{r3, r4, r5, lr}
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 21


 571              	.LCFI10:
 572              		.cfi_def_cfa_offset 16
 573              		.cfi_offset 3, -16
 574              		.cfi_offset 4, -12
 575              		.cfi_offset 5, -8
 576              		.cfi_offset 14, -4
  87:..//kernel/core/tos_priority_message_queue.c **** 
 577              		.loc 1 87 5 is_stmt 1 view .LVU165
  89:..//kernel/core/tos_priority_message_queue.c **** 
 578              		.loc 1 89 5 view .LVU166
  89:..//kernel/core/tos_priority_message_queue.c **** 
 579              		.loc 1 89 5 view .LVU167
 580 0002 88B1     		cbz	r0, .L35
 581 0004 0446     		mov	r4, r0
  91:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 582              		.loc 1 91 5 view .LVU168
  91:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 583              		.loc 1 91 11 is_stmt 0 view .LVU169
 584 0006 0422     		movs	r2, #4
 585 0008 1030     		adds	r0, r0, #16
 586              	.LVL75:
  91:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 587              		.loc 1 91 11 view .LVU170
 588 000a FFF7FEFF 		bl	tos_prio_q_create_dyn
 589              	.LVL76:
  92:..//kernel/core/tos_priority_message_queue.c ****         return err;
 590              		.loc 1 92 5 is_stmt 1 view .LVU171
  92:..//kernel/core/tos_priority_message_queue.c ****         return err;
 591              		.loc 1 92 8 is_stmt 0 view .LVU172
 592 000e 0546     		mov	r5, r0
 593 0010 08B1     		cbz	r0, .L37
 594              	.LVL77:
 595              	.L34:
 102:..//kernel/core/tos_priority_message_queue.c **** 
 596              		.loc 1 102 1 view .LVU173
 597 0012 2846     		mov	r0, r5
 598 0014 38BD     		pop	{r3, r4, r5, pc}
 599              	.LVL78:
 600              	.L37:
  96:..//kernel/core/tos_priority_message_queue.c **** 
 601              		.loc 1 96 5 is_stmt 1 view .LVU174
 602 0016 201D     		adds	r0, r4, #4
 603              	.LVL79:
  96:..//kernel/core/tos_priority_message_queue.c **** 
 604              		.loc 1 96 5 is_stmt 0 view .LVU175
 605 0018 FFF7FEFF 		bl	pend_object_init
 606              	.LVL80:
  98:..//kernel/core/tos_priority_message_queue.c ****     knl_object_alloc_set_dynamic(&prio_msg_q->knl_obj);
 607              		.loc 1 98 5 is_stmt 1 view .LVU176
 608              	.LBB46:
 609              	.LBI46:
 187:..//kernel/core/include/tos_sys.h **** {
 610              		.loc 2 187 32 view .LVU177
 611              	.LBB47:
 189:..//kernel/core/include/tos_sys.h **** }
 612              		.loc 2 189 5 view .LVU178
 189:..//kernel/core/include/tos_sys.h **** }
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 22


 613              		.loc 2 189 19 is_stmt 0 view .LVU179
 614 001c 48F6EE33 		movw	r3, #35822
 615 0020 6380     		strh	r3, [r4, #2]	@ movhi
 616              	.LVL81:
 189:..//kernel/core/include/tos_sys.h **** }
 617              		.loc 2 189 19 view .LVU180
 618              	.LBE47:
 619              	.LBE46:
  99:..//kernel/core/tos_priority_message_queue.c **** 
 620              		.loc 1 99 5 is_stmt 1 view .LVU181
 621              	.LBB48:
 622              	.LBI48:
 204:..//kernel/core/include/tos_sys.h **** {
 623              		.loc 2 204 32 view .LVU182
 624              	.LBB49:
 206:..//kernel/core/include/tos_sys.h **** }
 625              		.loc 2 206 5 view .LVU183
 206:..//kernel/core/include/tos_sys.h **** }
 626              		.loc 2 206 25 is_stmt 0 view .LVU184
 627 0022 0223     		movs	r3, #2
 628 0024 2370     		strb	r3, [r4]
 629              	.LVL82:
 206:..//kernel/core/include/tos_sys.h **** }
 630              		.loc 2 206 25 view .LVU185
 631              	.LBE49:
 632              	.LBE48:
 101:..//kernel/core/tos_priority_message_queue.c **** }
 633              		.loc 1 101 5 is_stmt 1 view .LVU186
 101:..//kernel/core/tos_priority_message_queue.c **** }
 634              		.loc 1 101 12 is_stmt 0 view .LVU187
 635 0026 F4E7     		b	.L34
 636              	.LVL83:
 637              	.L35:
  89:..//kernel/core/tos_priority_message_queue.c **** 
 638              		.loc 1 89 5 view .LVU188
 639 0028 40F24C45 		movw	r5, #1100
 640 002c F1E7     		b	.L34
 641              		.cfi_endproc
 642              	.LFE112:
 644              		.section	.text.tos_prio_msg_q_destroy_dyn,"ax",%progbits
 645              		.align	1
 646              		.global	tos_prio_msg_q_destroy_dyn
 647              		.syntax unified
 648              		.thumb
 649              		.thumb_func
 650              		.fpu softvfp
 652              	tos_prio_msg_q_destroy_dyn:
 653              	.LVL84:
 654              	.LFB113:
 105:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_CPSR_ALLOC();
 655              		.loc 1 105 1 is_stmt 1 view -0
 656              		.cfi_startproc
 657              		@ args = 0, pretend = 0, frame = 0
 658              		@ frame_needed = 0, uses_anonymous_args = 0
 105:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_CPSR_ALLOC();
 659              		.loc 1 105 1 is_stmt 0 view .LVU190
 660 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 23


 661              	.LCFI11:
 662              		.cfi_def_cfa_offset 24
 663              		.cfi_offset 4, -24
 664              		.cfi_offset 5, -20
 665              		.cfi_offset 6, -16
 666              		.cfi_offset 7, -12
 667              		.cfi_offset 8, -8
 668              		.cfi_offset 14, -4
 106:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
 669              		.loc 1 106 5 is_stmt 1 view .LVU191
 670              	.LVL85:
 107:..//kernel/core/tos_priority_message_queue.c **** 
 671              		.loc 1 107 5 view .LVU192
 109:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 672              		.loc 1 109 5 view .LVU193
 109:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 673              		.loc 1 109 5 view .LVU194
 674 0004 70B3     		cbz	r0, .L41
 675 0006 0446     		mov	r4, r0
 110:..//kernel/core/tos_priority_message_queue.c **** 
 676              		.loc 1 110 5 view .LVU195
 110:..//kernel/core/tos_priority_message_queue.c **** 
 677              		.loc 1 110 5 view .LVU196
 678              	.LVL86:
 679              	.LBB50:
 680              	.LBI50:
 182:..//kernel/core/include/tos_sys.h **** {
 681              		.loc 2 182 31 view .LVU197
 682              	.LBB51:
 184:..//kernel/core/include/tos_sys.h **** }
 683              		.loc 2 184 5 view .LVU198
 184:..//kernel/core/include/tos_sys.h **** }
 684              		.loc 2 184 19 is_stmt 0 view .LVU199
 685 0008 4188     		ldrh	r1, [r0, #2]
 686              	.LVL87:
 184:..//kernel/core/include/tos_sys.h **** }
 687              		.loc 2 184 19 view .LVU200
 688              	.LBE51:
 689              	.LBE50:
 110:..//kernel/core/tos_priority_message_queue.c **** 
 690              		.loc 1 110 5 view .LVU201
 691 000a 48F6EE32 		movw	r2, #35822
 692 000e 9142     		cmp	r1, r2
 693 0010 2BD1     		bne	.L42
 112:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_OBJ_INVALID_ALLOC_TYPE;
 694              		.loc 1 112 5 is_stmt 1 view .LVU202
 695              	.LVL88:
 696              	.LBB52:
 697              	.LBI52:
 214:..//kernel/core/include/tos_sys.h **** {
 698              		.loc 2 214 31 view .LVU203
 699              	.LBB53:
 216:..//kernel/core/include/tos_sys.h **** }
 700              		.loc 2 216 5 view .LVU204
 216:..//kernel/core/include/tos_sys.h **** }
 701              		.loc 2 216 19 is_stmt 0 view .LVU205
 702 0012 0278     		ldrb	r2, [r0]	@ zero_extendqisi2
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 24


 703              	.LVL89:
 216:..//kernel/core/include/tos_sys.h **** }
 704              		.loc 2 216 19 view .LVU206
 705              	.LBE53:
 706              	.LBE52:
 112:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_OBJ_INVALID_ALLOC_TYPE;
 707              		.loc 1 112 8 view .LVU207
 708 0014 022A     		cmp	r2, #2
 709 0016 02D0     		beq	.L45
 113:..//kernel/core/tos_priority_message_queue.c ****     }
 710              		.loc 1 113 16 view .LVU208
 711 0018 40F24E45 		movw	r5, #1102
 712 001c 27E0     		b	.L39
 713              	.L45:
 116:..//kernel/core/tos_priority_message_queue.c **** 
 714              		.loc 1 116 5 is_stmt 1 view .LVU209
 116:..//kernel/core/tos_priority_message_queue.c **** 
 715              		.loc 1 116 5 view .LVU210
 716 001e FFF7FEFF 		bl	tos_cpu_cpsr_save
 717              	.LVL90:
 116:..//kernel/core/tos_priority_message_queue.c **** 
 718              		.loc 1 116 5 is_stmt 0 view .LVU211
 719 0022 0746     		mov	r7, r0
 720              	.LVL91:
 118:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 721              		.loc 1 118 5 is_stmt 1 view .LVU212
 118:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 722              		.loc 1 118 11 is_stmt 0 view .LVU213
 723 0024 04F11000 		add	r0, r4, #16
 724              	.LVL92:
 118:..//kernel/core/tos_priority_message_queue.c ****     if (err != K_ERR_NONE) {
 725              		.loc 1 118 11 view .LVU214
 726 0028 FFF7FEFF 		bl	tos_prio_q_destroy_dyn
 727              	.LVL93:
 119:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 728              		.loc 1 119 5 is_stmt 1 view .LVU215
 119:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 729              		.loc 1 119 8 is_stmt 0 view .LVU216
 730 002c 0546     		mov	r5, r0
 731 002e A8B9     		cbnz	r0, .L46
 124:..//kernel/core/tos_priority_message_queue.c **** 
 732              		.loc 1 124 5 is_stmt 1 view .LVU217
 733 0030 04F10408 		add	r8, r4, #4
 734 0034 0321     		movs	r1, #3
 735 0036 4046     		mov	r0, r8
 736              	.LVL94:
 124:..//kernel/core/tos_priority_message_queue.c **** 
 737              		.loc 1 124 5 is_stmt 0 view .LVU218
 738 0038 FFF7FEFF 		bl	pend_wakeup_all
 739              	.LVL95:
 126:..//kernel/core/tos_priority_message_queue.c ****     prio_msg_q->prio_q_mgr_array = K_NULL;
 740              		.loc 1 126 5 is_stmt 1 view .LVU219
 741 003c E068     		ldr	r0, [r4, #12]
 742 003e FFF7FEFF 		bl	tos_mmheap_free
 743              	.LVL96:
 127:..//kernel/core/tos_priority_message_queue.c **** 
 744              		.loc 1 127 5 view .LVU220
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 25


 127:..//kernel/core/tos_priority_message_queue.c **** 
 745              		.loc 1 127 34 is_stmt 0 view .LVU221
 746 0042 0026     		movs	r6, #0
 747 0044 E660     		str	r6, [r4, #12]
 129:..//kernel/core/tos_priority_message_queue.c **** 
 748              		.loc 1 129 5 is_stmt 1 view .LVU222
 749 0046 4046     		mov	r0, r8
 750 0048 FFF7FEFF 		bl	pend_object_deinit
 751              	.LVL97:
 131:..//kernel/core/tos_priority_message_queue.c ****     knl_object_alloc_reset(&prio_msg_q->knl_obj);
 752              		.loc 1 131 5 view .LVU223
 753              	.LBB54:
 754              	.LBI54:
 192:..//kernel/core/include/tos_sys.h **** {
 755              		.loc 2 192 32 view .LVU224
 756              	.LBB55:
 194:..//kernel/core/include/tos_sys.h **** }
 757              		.loc 2 194 5 view .LVU225
 194:..//kernel/core/include/tos_sys.h **** }
 758              		.loc 2 194 19 is_stmt 0 view .LVU226
 759 004c 6680     		strh	r6, [r4, #2]	@ movhi
 760              	.LVL98:
 194:..//kernel/core/include/tos_sys.h **** }
 761              		.loc 2 194 19 view .LVU227
 762              	.LBE55:
 763              	.LBE54:
 132:..//kernel/core/tos_priority_message_queue.c **** 
 764              		.loc 1 132 5 is_stmt 1 view .LVU228
 765              	.LBB56:
 766              	.LBI56:
 199:..//kernel/core/include/tos_sys.h **** {
 767              		.loc 2 199 32 view .LVU229
 768              	.LBB57:
 201:..//kernel/core/include/tos_sys.h **** }
 769              		.loc 2 201 5 view .LVU230
 201:..//kernel/core/include/tos_sys.h **** }
 770              		.loc 2 201 25 is_stmt 0 view .LVU231
 771 004e 2670     		strb	r6, [r4]
 772              	.LVL99:
 201:..//kernel/core/include/tos_sys.h **** }
 773              		.loc 2 201 25 view .LVU232
 774              	.LBE57:
 775              	.LBE56:
 134:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 776              		.loc 1 134 5 is_stmt 1 view .LVU233
 134:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 777              		.loc 1 134 5 view .LVU234
 778 0050 3846     		mov	r0, r7
 779 0052 FFF7FEFF 		bl	tos_cpu_cpsr_restore
 780              	.LVL100:
 135:..//kernel/core/tos_priority_message_queue.c **** 
 781              		.loc 1 135 5 view .LVU235
 782 0056 FFF7FEFF 		bl	knl_sched
 783              	.LVL101:
 137:..//kernel/core/tos_priority_message_queue.c **** }
 784              		.loc 1 137 5 view .LVU236
 137:..//kernel/core/tos_priority_message_queue.c **** }
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 26


 785              		.loc 1 137 12 is_stmt 0 view .LVU237
 786 005a 08E0     		b	.L39
 787              	.LVL102:
 788              	.L46:
 120:..//kernel/core/tos_priority_message_queue.c ****         return err;
 789              		.loc 1 120 9 is_stmt 1 view .LVU238
 120:..//kernel/core/tos_priority_message_queue.c ****         return err;
 790              		.loc 1 120 9 view .LVU239
 791 005c 3846     		mov	r0, r7
 792              	.LVL103:
 120:..//kernel/core/tos_priority_message_queue.c ****         return err;
 793              		.loc 1 120 9 is_stmt 0 view .LVU240
 794 005e FFF7FEFF 		bl	tos_cpu_cpsr_restore
 795              	.LVL104:
 121:..//kernel/core/tos_priority_message_queue.c ****     }
 796              		.loc 1 121 9 is_stmt 1 view .LVU241
 121:..//kernel/core/tos_priority_message_queue.c ****     }
 797              		.loc 1 121 16 is_stmt 0 view .LVU242
 798 0062 04E0     		b	.L39
 799              	.LVL105:
 800              	.L41:
 109:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 801              		.loc 1 109 5 view .LVU243
 802 0064 40F24C45 		movw	r5, #1100
 803 0068 01E0     		b	.L39
 804              	.L42:
 110:..//kernel/core/tos_priority_message_queue.c **** 
 805              		.loc 1 110 5 view .LVU244
 806 006a 40F24D45 		movw	r5, #1101
 807              	.LVL106:
 808              	.L39:
 138:..//kernel/core/tos_priority_message_queue.c **** 
 809              		.loc 1 138 1 view .LVU245
 810 006e 2846     		mov	r0, r5
 811 0070 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 812              		.cfi_endproc
 813              	.LFE113:
 815              		.section	.text.tos_prio_msg_q_flush,"ax",%progbits
 816              		.align	1
 817              		.global	tos_prio_msg_q_flush
 818              		.syntax unified
 819              		.thumb
 820              		.thumb_func
 821              		.fpu softvfp
 823              	tos_prio_msg_q_flush:
 824              	.LVL107:
 825              	.LFB114:
 141:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
 826              		.loc 1 141 1 is_stmt 1 view -0
 827              		.cfi_startproc
 828              		@ args = 0, pretend = 0, frame = 0
 829              		@ frame_needed = 0, uses_anonymous_args = 0
 142:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 830              		.loc 1 142 5 view .LVU247
 142:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 831              		.loc 1 142 5 view .LVU248
 832 0000 60B1     		cbz	r0, .L49
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 27


 141:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
 833              		.loc 1 141 1 is_stmt 0 view .LVU249
 834 0002 08B5     		push	{r3, lr}
 835              	.LCFI12:
 836              		.cfi_def_cfa_offset 8
 837              		.cfi_offset 3, -8
 838              		.cfi_offset 14, -4
 143:..//kernel/core/tos_priority_message_queue.c **** 
 839              		.loc 1 143 5 is_stmt 1 view .LVU250
 143:..//kernel/core/tos_priority_message_queue.c **** 
 840              		.loc 1 143 5 view .LVU251
 841              	.LVL108:
 842              	.LBB58:
 843              	.LBI58:
 182:..//kernel/core/include/tos_sys.h **** {
 844              		.loc 2 182 31 view .LVU252
 845              	.LBB59:
 184:..//kernel/core/include/tos_sys.h **** }
 846              		.loc 2 184 5 view .LVU253
 184:..//kernel/core/include/tos_sys.h **** }
 847              		.loc 2 184 19 is_stmt 0 view .LVU254
 848 0004 4188     		ldrh	r1, [r0, #2]
 849              	.LVL109:
 184:..//kernel/core/include/tos_sys.h **** }
 850              		.loc 2 184 19 view .LVU255
 851              	.LBE59:
 852              	.LBE58:
 143:..//kernel/core/tos_priority_message_queue.c **** 
 853              		.loc 1 143 5 view .LVU256
 854 0006 48F6EE32 		movw	r2, #35822
 855 000a 9142     		cmp	r1, r2
 856 000c 02D0     		beq	.L55
 857 000e 40F24D40 		movw	r0, #1101
 858              	.LVL110:
 859              	.L48:
 146:..//kernel/core/tos_priority_message_queue.c **** 
 860              		.loc 1 146 1 view .LVU257
 861 0012 08BD     		pop	{r3, pc}
 862              	.LVL111:
 863              	.L55:
 145:..//kernel/core/tos_priority_message_queue.c **** }
 864              		.loc 1 145 5 is_stmt 1 view .LVU258
 145:..//kernel/core/tos_priority_message_queue.c **** }
 865              		.loc 1 145 12 is_stmt 0 view .LVU259
 866 0014 1030     		adds	r0, r0, #16
 867              	.LVL112:
 145:..//kernel/core/tos_priority_message_queue.c **** }
 868              		.loc 1 145 12 view .LVU260
 869 0016 FFF7FEFF 		bl	tos_prio_q_flush
 870              	.LVL113:
 145:..//kernel/core/tos_priority_message_queue.c **** }
 871              		.loc 1 145 12 view .LVU261
 872 001a FAE7     		b	.L48
 873              	.LVL114:
 874              	.L49:
 875              	.LCFI13:
 876              		.cfi_def_cfa_offset 0
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 28


 877              		.cfi_restore 3
 878              		.cfi_restore 14
 142:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 879              		.loc 1 142 5 view .LVU262
 880 001c 40F24C40 		movw	r0, #1100
 881              	.LVL115:
 146:..//kernel/core/tos_priority_message_queue.c **** 
 882              		.loc 1 146 1 view .LVU263
 883 0020 7047     		bx	lr
 884              		.cfi_endproc
 885              	.LFE114:
 887              		.section	.text.tos_prio_msg_q_pend,"ax",%progbits
 888              		.align	1
 889              		.global	tos_prio_msg_q_pend
 890              		.syntax unified
 891              		.thumb
 892              		.thumb_func
 893              		.fpu softvfp
 895              	tos_prio_msg_q_pend:
 896              	.LVL116:
 897              	.LFB115:
 149:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_CPSR_ALLOC();
 898              		.loc 1 149 1 is_stmt 1 view -0
 899              		.cfi_startproc
 900              		@ args = 0, pretend = 0, frame = 0
 901              		@ frame_needed = 0, uses_anonymous_args = 0
 149:..//kernel/core/tos_priority_message_queue.c ****     TOS_CPU_CPSR_ALLOC();
 902              		.loc 1 149 1 is_stmt 0 view .LVU265
 903 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 904              	.LCFI14:
 905              		.cfi_def_cfa_offset 32
 906              		.cfi_offset 3, -32
 907              		.cfi_offset 4, -28
 908              		.cfi_offset 5, -24
 909              		.cfi_offset 6, -20
 910              		.cfi_offset 7, -16
 911              		.cfi_offset 8, -12
 912              		.cfi_offset 9, -8
 913              		.cfi_offset 14, -4
 914 0004 0446     		mov	r4, r0
 915 0006 0D46     		mov	r5, r1
 916 0008 9046     		mov	r8, r2
 917 000a 9946     		mov	r9, r3
 150:..//kernel/core/tos_priority_message_queue.c ****     k_err_t err;
 918              		.loc 1 150 5 is_stmt 1 view .LVU266
 919              	.LVL117:
 151:..//kernel/core/tos_priority_message_queue.c **** 
 920              		.loc 1 151 5 view .LVU267
 153:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
 921              		.loc 1 153 5 view .LVU268
 153:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
 922              		.loc 1 153 5 view .LVU269
 923 000c FFF7FEFF 		bl	knl_is_inirq
 924              	.LVL118:
 153:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
 925              		.loc 1 153 5 is_stmt 0 view .LVU270
 926 0010 0028     		cmp	r0, #0
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 29


 927 0012 4DD1     		bne	.L61
 154:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(msg_ptr);
 928              		.loc 1 154 5 is_stmt 1 view .LVU271
 154:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(msg_ptr);
 929              		.loc 1 154 5 view .LVU272
 930 0014 002C     		cmp	r4, #0
 931 0016 4ED0     		beq	.L62
 155:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 932              		.loc 1 155 5 view .LVU273
 155:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 933              		.loc 1 155 5 view .LVU274
 934 0018 002D     		cmp	r5, #0
 935 001a 4FD0     		beq	.L63
 156:..//kernel/core/tos_priority_message_queue.c **** 
 936              		.loc 1 156 5 view .LVU275
 156:..//kernel/core/tos_priority_message_queue.c **** 
 937              		.loc 1 156 5 view .LVU276
 938              	.LVL119:
 939              	.LBB60:
 940              	.LBI60:
 182:..//kernel/core/include/tos_sys.h **** {
 941              		.loc 2 182 31 view .LVU277
 942              	.LBB61:
 184:..//kernel/core/include/tos_sys.h **** }
 943              		.loc 2 184 5 view .LVU278
 184:..//kernel/core/include/tos_sys.h **** }
 944              		.loc 2 184 19 is_stmt 0 view .LVU279
 945 001c 6288     		ldrh	r2, [r4, #2]
 946              	.LVL120:
 184:..//kernel/core/include/tos_sys.h **** }
 947              		.loc 2 184 19 view .LVU280
 948              	.LBE61:
 949              	.LBE60:
 156:..//kernel/core/tos_priority_message_queue.c **** 
 950              		.loc 1 156 5 view .LVU281
 951 001e 48F6EE33 		movw	r3, #35822
 952 0022 9A42     		cmp	r2, r3
 953 0024 04D0     		beq	.L66
 954 0026 40F24D46 		movw	r6, #1101
 955              	.LVL121:
 956              	.L57:
 188:..//kernel/core/tos_priority_message_queue.c **** 
 957              		.loc 1 188 1 view .LVU282
 958 002a 3046     		mov	r0, r6
 959 002c BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 960              	.LVL122:
 961              	.L66:
 158:..//kernel/core/tos_priority_message_queue.c **** 
 962              		.loc 1 158 5 is_stmt 1 view .LVU283
 158:..//kernel/core/tos_priority_message_queue.c **** 
 963              		.loc 1 158 5 view .LVU284
 964 0030 FFF7FEFF 		bl	tos_cpu_cpsr_save
 965              	.LVL123:
 966 0034 0746     		mov	r7, r0
 967              	.LVL124:
 160:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 968              		.loc 1 160 5 view .LVU285
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 30


 160:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 969              		.loc 1 160 9 is_stmt 0 view .LVU286
 970 0036 0023     		movs	r3, #0
 971 0038 1A46     		mov	r2, r3
 972 003a 2946     		mov	r1, r5
 973 003c 04F11000 		add	r0, r4, #16
 974              	.LVL125:
 160:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 975              		.loc 1 160 9 view .LVU287
 976 0040 FFF7FEFF 		bl	tos_prio_q_dequeue
 977              	.LVL126:
 160:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 978              		.loc 1 160 8 view .LVU288
 979 0044 0646     		mov	r6, r0
 980 0046 08B3     		cbz	r0, .L67
 165:..//kernel/core/tos_priority_message_queue.c ****         *msg_ptr = K_NULL;
 981              		.loc 1 165 5 is_stmt 1 view .LVU289
 165:..//kernel/core/tos_priority_message_queue.c ****         *msg_ptr = K_NULL;
 982              		.loc 1 165 8 is_stmt 0 view .LVU290
 983 0048 58EA0903 		orrs	r3, r8, r9
 984 004c 22D0     		beq	.L68
 171:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 985              		.loc 1 171 5 is_stmt 1 view .LVU291
 171:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 986              		.loc 1 171 9 is_stmt 0 view .LVU292
 987 004e FFF7FEFF 		bl	knl_is_sched_locked
 988              	.LVL127:
 171:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 989              		.loc 1 171 8 view .LVU293
 990 0052 38BB     		cbnz	r0, .L69
 176:..//kernel/core/tos_priority_message_queue.c **** 
 991              		.loc 1 176 5 is_stmt 1 view .LVU294
 992 0054 1B4E     		ldr	r6, .L70
 993 0056 4246     		mov	r2, r8
 994 0058 4B46     		mov	r3, r9
 995 005a 211D     		adds	r1, r4, #4
 996 005c 3068     		ldr	r0, [r6]
 997 005e FFF7FEFF 		bl	pend_task_block
 998              	.LVL128:
 178:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 999              		.loc 1 178 5 view .LVU295
 178:..//kernel/core/tos_priority_message_queue.c ****     knl_sched();
 1000              		.loc 1 178 5 view .LVU296
 1001 0062 3846     		mov	r0, r7
 1002 0064 FFF7FEFF 		bl	tos_cpu_cpsr_restore
 1003              	.LVL129:
 179:..//kernel/core/tos_priority_message_queue.c **** 
 1004              		.loc 1 179 5 view .LVU297
 1005 0068 FFF7FEFF 		bl	knl_sched
 1006              	.LVL130:
 181:..//kernel/core/tos_priority_message_queue.c ****     if (err == K_ERR_NONE) {
 1007              		.loc 1 181 5 view .LVU298
 181:..//kernel/core/tos_priority_message_queue.c ****     if (err == K_ERR_NONE) {
 1008              		.loc 1 181 39 is_stmt 0 view .LVU299
 1009 006c 3368     		ldr	r3, [r6]
 181:..//kernel/core/tos_priority_message_queue.c ****     if (err == K_ERR_NONE) {
 1010              		.loc 1 181 11 view .LVU300
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 31


 1011 006e 93F86800 		ldrb	r0, [r3, #104]	@ zero_extendqisi2
 1012 0072 FFF7FEFF 		bl	pend_state2errno
 1013              	.LVL131:
 182:..//kernel/core/tos_priority_message_queue.c ****         *msg_ptr            = k_curr_task->msg;
 1014              		.loc 1 182 5 is_stmt 1 view .LVU301
 182:..//kernel/core/tos_priority_message_queue.c ****         *msg_ptr            = k_curr_task->msg;
 1015              		.loc 1 182 8 is_stmt 0 view .LVU302
 1016 0076 0646     		mov	r6, r0
 1017 0078 0028     		cmp	r0, #0
 1018 007a D6D1     		bne	.L57
 183:..//kernel/core/tos_priority_message_queue.c ****         k_curr_task->msg    = K_NULL;
 1019              		.loc 1 183 9 is_stmt 1 view .LVU303
 183:..//kernel/core/tos_priority_message_queue.c ****         k_curr_task->msg    = K_NULL;
 1020              		.loc 1 183 42 is_stmt 0 view .LVU304
 1021 007c 114B     		ldr	r3, .L70
 1022 007e 1A68     		ldr	r2, [r3]
 1023 0080 D26E     		ldr	r2, [r2, #108]
 183:..//kernel/core/tos_priority_message_queue.c ****         k_curr_task->msg    = K_NULL;
 1024              		.loc 1 183 29 view .LVU305
 1025 0082 2A60     		str	r2, [r5]
 184:..//kernel/core/tos_priority_message_queue.c ****     }
 1026              		.loc 1 184 9 is_stmt 1 view .LVU306
 184:..//kernel/core/tos_priority_message_queue.c ****     }
 1027              		.loc 1 184 20 is_stmt 0 view .LVU307
 1028 0084 1B68     		ldr	r3, [r3]
 184:..//kernel/core/tos_priority_message_queue.c ****     }
 1029              		.loc 1 184 29 view .LVU308
 1030 0086 0022     		movs	r2, #0
 1031 0088 DA66     		str	r2, [r3, #108]
 1032 008a CEE7     		b	.L57
 1033              	.LVL132:
 1034              	.L67:
 161:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_NONE;
 1035              		.loc 1 161 9 is_stmt 1 view .LVU309
 161:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_NONE;
 1036              		.loc 1 161 9 view .LVU310
 1037 008c 3846     		mov	r0, r7
 1038 008e FFF7FEFF 		bl	tos_cpu_cpsr_restore
 1039              	.LVL133:
 162:..//kernel/core/tos_priority_message_queue.c ****     }
 1040              		.loc 1 162 9 view .LVU311
 162:..//kernel/core/tos_priority_message_queue.c ****     }
 1041              		.loc 1 162 16 is_stmt 0 view .LVU312
 1042 0092 CAE7     		b	.L57
 1043              	.L68:
 166:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 1044              		.loc 1 166 9 is_stmt 1 view .LVU313
 166:..//kernel/core/tos_priority_message_queue.c ****         TOS_CPU_INT_ENABLE();
 1045              		.loc 1 166 18 is_stmt 0 view .LVU314
 1046 0094 0023     		movs	r3, #0
 1047 0096 2B60     		str	r3, [r5]
 167:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_PEND_NOWAIT;
 1048              		.loc 1 167 9 is_stmt 1 view .LVU315
 167:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_PEND_NOWAIT;
 1049              		.loc 1 167 9 view .LVU316
 1050 0098 3846     		mov	r0, r7
 1051 009a FFF7FEFF 		bl	tos_cpu_cpsr_restore
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 32


 1052              	.LVL134:
 168:..//kernel/core/tos_priority_message_queue.c ****     }
 1053              		.loc 1 168 9 view .LVU317
 168:..//kernel/core/tos_priority_message_queue.c ****     }
 1054              		.loc 1 168 16 is_stmt 0 view .LVU318
 1055 009e 4FF49666 		mov	r6, #1200
 1056 00a2 C2E7     		b	.L57
 1057              	.L69:
 172:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_PEND_SCHED_LOCKED;
 1058              		.loc 1 172 9 is_stmt 1 view .LVU319
 172:..//kernel/core/tos_priority_message_queue.c ****         return K_ERR_PEND_SCHED_LOCKED;
 1059              		.loc 1 172 9 view .LVU320
 1060 00a4 3846     		mov	r0, r7
 1061 00a6 FFF7FEFF 		bl	tos_cpu_cpsr_restore
 1062              	.LVL135:
 173:..//kernel/core/tos_priority_message_queue.c ****     }
 1063              		.loc 1 173 9 view .LVU321
 173:..//kernel/core/tos_priority_message_queue.c ****     }
 1064              		.loc 1 173 16 is_stmt 0 view .LVU322
 1065 00aa 40F2B146 		movw	r6, #1201
 1066 00ae BCE7     		b	.L57
 1067              	.LVL136:
 1068              	.L61:
 153:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(prio_msg_q);
 1069              		.loc 1 153 5 view .LVU323
 1070 00b0 4FF4C876 		mov	r6, #400
 1071 00b4 B9E7     		b	.L57
 1072              	.L62:
 154:..//kernel/core/tos_priority_message_queue.c ****     TOS_PTR_SANITY_CHECK(msg_ptr);
 1073              		.loc 1 154 5 view .LVU324
 1074 00b6 40F24C46 		movw	r6, #1100
 1075 00ba B6E7     		b	.L57
 1076              	.L63:
 155:..//kernel/core/tos_priority_message_queue.c ****     TOS_OBJ_VERIFY(prio_msg_q, KNL_OBJ_TYPE_PRIORITY_MESSAGE_QUEUE);
 1077              		.loc 1 155 5 view .LVU325
 1078 00bc 40F24C46 		movw	r6, #1100
 1079 00c0 B3E7     		b	.L57
 1080              	.L71:
 1081 00c2 00BF     		.align	2
 1082              	.L70:
 1083 00c4 00000000 		.word	k_curr_task
 1084              		.cfi_endproc
 1085              	.LFE115:
 1087              		.section	.text.tos_prio_msg_q_post,"ax",%progbits
 1088              		.align	1
 1089              		.global	tos_prio_msg_q_post
 1090              		.syntax unified
 1091              		.thumb
 1092              		.thumb_func
 1093              		.fpu softvfp
 1095              	tos_prio_msg_q_post:
 1096              	.LVL137:
 1097              	.LFB118:
 230:..//kernel/core/tos_priority_message_queue.c **** 
 231:..//kernel/core/tos_priority_message_queue.c **** __API__ k_err_t tos_prio_msg_q_post(k_prio_msg_q_t *prio_msg_q, void *msg_ptr, k_prio_t prio)
 232:..//kernel/core/tos_priority_message_queue.c **** {
 1098              		.loc 1 232 1 is_stmt 1 view -0
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 33


 1099              		.cfi_startproc
 1100              		@ args = 0, pretend = 0, frame = 0
 1101              		@ frame_needed = 0, uses_anonymous_args = 0
 1102              		.loc 1 232 1 is_stmt 0 view .LVU327
 1103 0000 08B5     		push	{r3, lr}
 1104              	.LCFI15:
 1105              		.cfi_def_cfa_offset 8
 1106              		.cfi_offset 3, -8
 1107              		.cfi_offset 14, -4
 233:..//kernel/core/tos_priority_message_queue.c ****     return prio_msg_q_do_post(prio_msg_q, msg_ptr, prio, OPT_POST_ONE);
 1108              		.loc 1 233 5 is_stmt 1 view .LVU328
 1109              		.loc 1 233 12 is_stmt 0 view .LVU329
 1110 0002 0023     		movs	r3, #0
 1111 0004 FFF7FEFF 		bl	prio_msg_q_do_post
 1112              	.LVL138:
 234:..//kernel/core/tos_priority_message_queue.c **** }
 1113              		.loc 1 234 1 view .LVU330
 1114 0008 08BD     		pop	{r3, pc}
 1115              		.cfi_endproc
 1116              	.LFE118:
 1118              		.section	.text.tos_prio_msg_q_post_all,"ax",%progbits
 1119              		.align	1
 1120              		.global	tos_prio_msg_q_post_all
 1121              		.syntax unified
 1122              		.thumb
 1123              		.thumb_func
 1124              		.fpu softvfp
 1126              	tos_prio_msg_q_post_all:
 1127              	.LVL139:
 1128              	.LFB119:
 235:..//kernel/core/tos_priority_message_queue.c **** 
 236:..//kernel/core/tos_priority_message_queue.c **** __API__ k_err_t tos_prio_msg_q_post_all(k_prio_msg_q_t *prio_msg_q, void *msg_ptr, k_prio_t prio)
 237:..//kernel/core/tos_priority_message_queue.c **** {
 1129              		.loc 1 237 1 is_stmt 1 view -0
 1130              		.cfi_startproc
 1131              		@ args = 0, pretend = 0, frame = 0
 1132              		@ frame_needed = 0, uses_anonymous_args = 0
 1133              		.loc 1 237 1 is_stmt 0 view .LVU332
 1134 0000 08B5     		push	{r3, lr}
 1135              	.LCFI16:
 1136              		.cfi_def_cfa_offset 8
 1137              		.cfi_offset 3, -8
 1138              		.cfi_offset 14, -4
 238:..//kernel/core/tos_priority_message_queue.c ****     return prio_msg_q_do_post(prio_msg_q, msg_ptr, prio, OPT_POST_ALL);
 1139              		.loc 1 238 5 is_stmt 1 view .LVU333
 1140              		.loc 1 238 12 is_stmt 0 view .LVU334
 1141 0002 0123     		movs	r3, #1
 1142 0004 FFF7FEFF 		bl	prio_msg_q_do_post
 1143              	.LVL140:
 239:..//kernel/core/tos_priority_message_queue.c **** }
 1144              		.loc 1 239 1 view .LVU335
 1145 0008 08BD     		pop	{r3, pc}
 1146              		.cfi_endproc
 1147              	.LFE119:
 1149              		.text
 1150              	.Letext0:
 1151              		.file 3 "..//kernel/core/include/tos_kerr.h"
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 34


 1152              		.file 4 "d:\\arm_gcc\\8 2019-q3-update\\arm-none-eabi\\include\\machine\\_default_types.h"
 1153              		.file 5 "d:\\arm_gcc\\8 2019-q3-update\\arm-none-eabi\\include\\sys\\_stdint.h"
 1154              		.file 6 "Drivers/CMSIS/Include/core_cm3.h"
 1155              		.file 7 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/system_stm32f1xx.h"
 1156              		.file 8 "d:\\arm_gcc\\8 2019-q3-update\\lib\\gcc\\arm-none-eabi\\8.3.1\\include\\stddef.h"
 1157              		.file 9 "d:\\arm_gcc\\8 2019-q3-update\\arm-none-eabi\\include\\sys\\_types.h"
 1158              		.file 10 "d:\\arm_gcc\\8 2019-q3-update\\arm-none-eabi\\include\\sys\\reent.h"
 1159              		.file 11 "d:\\arm_gcc\\8 2019-q3-update\\arm-none-eabi\\include\\sys\\lock.h"
 1160              		.file 12 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal.h"
 1161              		.file 13 "..//arch/arm/arm-v7m/common/include/tos_cpu_types.h"
 1162              		.file 14 "..//kernel/core/include/tos_ktypes.h"
 1163              		.file 15 "..//kernel/core/include/tos_task.h"
 1164              		.file 16 "d:\\arm_gcc\\8 2019-q3-update\\arm-none-eabi\\include\\stdlib.h"
 1165              		.file 17 "..//kernel/core/include/tos_list.h"
 1166              		.file 18 "..//kernel/core/include/tos_pend.h"
 1167              		.file 19 "..//kernel/core/include/tos_binary_heap.h"
 1168              		.file 20 "..//kernel/core/include/tos_priority_queue.h"
 1169              		.file 21 "..//kernel/core/include/tos_priority_message_queue.h"
 1170              		.file 22 "..//kernel/core/include/tos_timer.h"
 1171              		.file 23 "..//kernel/core/include/tos_mmheap.h"
 1172              		.file 24 "..//kernel/core/include/tos_sched.h"
 1173              		.file 25 "..//kernel/core/include/tos_global.h"
 1174              		.file 26 "..//arch/arm/arm-v7m/common/include/tos_cpu.h"
ARM GAS  C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s 			page 35


DEFINED SYMBOLS
                            *ABS*:00000000 tos_priority_message_queue.c
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:16     .text.prio_msg_q_task_recv:00000000 $t
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:23     .text.prio_msg_q_task_recv:00000000 prio_msg_q_task_recv
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:52     .text.prio_msg_q_do_post:00000000 $t
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:58     .text.prio_msg_q_do_post:00000000 prio_msg_q_do_post
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:245    .text.tos_prio_msg_q_create:00000000 $t
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:252    .text.tos_prio_msg_q_create:00000000 tos_prio_msg_q_create
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:384    .text.tos_prio_msg_q_destroy:00000000 $t
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:391    .text.tos_prio_msg_q_destroy:00000000 tos_prio_msg_q_destroy
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:555    .text.tos_prio_msg_q_create_dyn:00000000 $t
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:562    .text.tos_prio_msg_q_create_dyn:00000000 tos_prio_msg_q_create_dyn
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:645    .text.tos_prio_msg_q_destroy_dyn:00000000 $t
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:652    .text.tos_prio_msg_q_destroy_dyn:00000000 tos_prio_msg_q_destroy_dyn
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:816    .text.tos_prio_msg_q_flush:00000000 $t
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:823    .text.tos_prio_msg_q_flush:00000000 tos_prio_msg_q_flush
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:888    .text.tos_prio_msg_q_pend:00000000 $t
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:895    .text.tos_prio_msg_q_pend:00000000 tos_prio_msg_q_pend
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:1083   .text.tos_prio_msg_q_pend:000000c4 $d
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:1088   .text.tos_prio_msg_q_post:00000000 $t
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:1095   .text.tos_prio_msg_q_post:00000000 tos_prio_msg_q_post
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:1119   .text.tos_prio_msg_q_post_all:00000000 $t
C:\Users\tianx\AppData\Local\Temp\ccgrQKAl.s:1126   .text.tos_prio_msg_q_post_all:00000000 tos_prio_msg_q_post_all

UNDEFINED SYMBOLS
pend_task_wakeup
tos_cpu_cpsr_save
pend_is_nopending
tos_prio_q_enqueue
tos_cpu_cpsr_restore
knl_sched
tos_mmheap_alloc
tos_prio_q_create
pend_object_init
tos_mmheap_free
tos_prio_q_destroy
pend_wakeup_all
pend_object_deinit
tos_prio_q_create_dyn
tos_prio_q_destroy_dyn
tos_prio_q_flush
knl_is_inirq
tos_prio_q_dequeue
knl_is_sched_locked
pend_task_block
pend_state2errno
k_curr_task
